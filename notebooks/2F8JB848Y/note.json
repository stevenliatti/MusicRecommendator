{
  "paragraphs": [
    {
      "text": "%md\n\n# Music Recommendator\n\n",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:44:55.620",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eMusic Recommendator\u003c/h1\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404160920_724976566",
      "id": "20200525-105600_876779769",
      "dateCreated": "2020-05-25 10:56:00.920",
      "dateStarted": "2020-06-03 10:44:55.686",
      "dateFinished": "2020-06-03 10:44:57.727",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Preparing the Data\n\nLet\u0027s start by downloading the data :\n",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:44:57.786",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003ePreparing the Data\u003c/h2\u003e\n\u003cp\u003eLet\u0026rsquo;s start by downloading the data :\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404204036_-155805845",
      "id": "20200525-105644_555166138",
      "dateCreated": "2020-05-25 10:56:44.037",
      "dateStarted": "2020-06-03 10:44:57.958",
      "dateFinished": "2020-06-03 10:44:57.980",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\ncd /data\nif [[ ! -d profiledata_06-May-2005 ]]\nthen\n    if [[ ! -f profiledata_06-May-2005.tar.xz ]]\n    then \n        echo \"Downloading profiledata_06-May-2005.tar.xz\"\n        curl --silent https://drive.switch.ch/index.php/s/gK6l44wTWixlaeC/download -o profiledata_06-May-2005.tar.xz\n        echo \"Extracting to profiledata_06-May-2005\"\n        tar xfv profiledata_06-May-2005.tar.xz\n    fi\nfi\nls -lhF profiledata_06-May-2005",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:44:58.062",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionSupport": false,
          "completionKey": "TAB"
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "total 464M\n-rw-r--r-- 1 1000 1000 2.8M May  6  2005 artist_alias.txt\n-rw-r--r-- 1 1000 1000  54M May  6  2005 artist_data.txt\n-rw-r--r-- 1 1000 1000 1.3K May 10  2005 README.txt\n-rw-r--r-- 1 1000 1000 407M May  5  2005 user_artist_data.txt\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590395388698_1190528192",
      "id": "20200525-082948_1820188021",
      "dateCreated": "2020-05-25 08:29:48.698",
      "dateStarted": "2020-06-03 10:44:58.162",
      "dateFinished": "2020-06-03 10:45:00.303",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nNext, read the user artist data and transform it in a Dataframe with two columns \"user\" and \"artist\" :",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:45:00.359",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eNext, read the user artist data and transform it in a Dataframe with two columns \u0026ldquo;user\u0026rdquo; and \u0026ldquo;artist\u0026rdquo; :\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404376466_270920040",
      "id": "20200525-105936_1453333316",
      "dateCreated": "2020-05-25 10:59:36.466",
      "dateStarted": "2020-06-03 10:45:00.431",
      "dateFinished": "2020-06-03 10:45:00.447",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval rawUserArtistData \u003d spark.read.textFile(\"/data/profiledata_06-May-2005/user_artist_data.txt\")\nrawUserArtistData.take(5).foreach(println)\n\nval userArtistDF \u003d rawUserArtistData.map { line \u003d\u003e \n    val Array(user, artist, _*) \u003d line.split(\u0027 \u0027)\n    (user.toInt, artist.toInt)\n}.toDF(\"user\", \"artist\")\nuserArtistDF.printSchema\nuserArtistDF.agg(min(\"user\"), max(\"user\"), min(\"artist\"), max(\"artist\")).show()",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:45:00.531",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "1000002 1 55\n1000002 1000006 33\n1000002 1000007 8\n1000002 1000009 144\n1000002 1000010 314\nroot\n |-- user: integer (nullable \u003d false)\n |-- artist: integer (nullable \u003d false)\n\n+---------+---------+-----------+-----------+\n|min(user)|max(user)|min(artist)|max(artist)|\n+---------+---------+-----------+-----------+\n|       90|  2443548|          1|   10794401|\n+---------+---------+-----------+-----------+\n\nrawUserArtistData: org.apache.spark.sql.Dataset[String] \u003d [value: string]\nuserArtistDF: org.apache.spark.sql.DataFrame \u003d [user: int, artist: int]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d0",
            "http://172.17.0.2:4040/jobs/job?id\u003d1"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590403079984_-213506736",
      "id": "20200525-103759_1452771728",
      "dateCreated": "2020-05-25 10:37:59.984",
      "dateStarted": "2020-06-03 10:45:00.603",
      "dateFinished": "2020-06-03 10:45:30.008",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nNext, read the raw artist data and transform it in a Dataframe with two columns \"id\" and \"name\" :",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:45:30.044",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eNext, read the raw artist data and transform it in a Dataframe with two columns \u0026ldquo;id\u0026rdquo; and \u0026ldquo;name\u0026rdquo; :\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404636907_1121945544",
      "id": "20200525-110356_1897971030",
      "dateCreated": "2020-05-25 11:03:56.907",
      "dateStarted": "2020-06-03 10:45:30.099",
      "dateFinished": "2020-06-03 10:45:30.112",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval rawArtistData \u003d spark.read.textFile(\"/data/profiledata_06-May-2005/artist_data.txt\")\nval artistByID \u003d rawArtistData.flatMap { line \u003d\u003e\n    val (id, name) \u003d line.span(_ !\u003d \u0027\\t\u0027)\n    if (name.isEmpty) None\n    else {\n        try Some((id.toInt, name.trim))\n        catch {\n            case _: NumberFormatException \u003d\u003e None\n        }\n    }\n}.toDF(\"id\", \"name\")",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:45:30.199",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "rawArtistData: org.apache.spark.sql.Dataset[String] \u003d [value: string]\nartistByID: org.apache.spark.sql.DataFrame \u003d [id: int, name: string]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404632088_1692483147",
      "id": "20200525-110352_2143376873",
      "dateCreated": "2020-05-25 11:03:52.088",
      "dateStarted": "2020-06-03 10:45:30.250",
      "dateFinished": "2020-06-03 10:45:31.046",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nNext, read the alias artist data and transform it in a Map with artist id for the key and alias for value :",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:45:31.068",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eNext, read the alias artist data and transform it in a Map with artist id for the key and alias for value :\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404719724_1188961969",
      "id": "20200525-110519_1836651915",
      "dateCreated": "2020-05-25 11:05:19.724",
      "dateStarted": "2020-06-03 10:45:31.238",
      "dateFinished": "2020-06-03 10:45:31.258",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval rawArtistAlias \u003d spark.read.textFile(\"/data/profiledata_06-May-2005/artist_alias.txt\")\nval artistAlias \u003d rawArtistAlias.flatMap { line \u003d\u003e\n    val Array(artist, alias) \u003d line.split(\u0027\\t\u0027)\n    if (artist.isEmpty) None\n    else Some((artist.toInt, alias.toInt))\n}.collect().toMap\n//artistAlias.head\n\nartistByID.filter($\"id\" isin (1208690, 1003926)).show()",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:45:31.324",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 92.6833,
              "optionOpen": false
            }
          }
        },
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+----------------+\n|     id|            name|\n+-------+----------------+\n|1208690|Collective Souls|\n|1003926| Collective Soul|\n+-------+----------------+\n\nrawArtistAlias: org.apache.spark.sql.Dataset[String] \u003d [value: string]\nartistAlias: scala.collection.immutable.Map[Int,Int] \u003d Map(1208690 -\u003e 1003926, 2012757 -\u003e 4569, 6949139 -\u003e 1085752, 1109727 -\u003e 1239120, 6772751 -\u003e 1244705, 2070533 -\u003e 1021544, 1157679 -\u003e 2194, 9969617 -\u003e 5630, 2034496 -\u003e 1116214, 6764342 -\u003e 40, 1272489 -\u003e 1278238, 2108744 -\u003e 1009267, 10349857 -\u003e 1000052, 2145319 -\u003e 1020463, 2126338 -\u003e 2717, 10165456 -\u003e 1001169, 6779368 -\u003e 1239506, 10278137 -\u003e 1001523, 9939075 -\u003e 1329390, 2037201 -\u003e 1274155, 1248585 -\u003e 2885, 1106945 -\u003e 1399, 6811322 -\u003e 1019016, 9978396 -\u003e 1784, 6676961 -\u003e 1086433, 2117821 -\u003e 2611, 6863616 -\u003e 1277013, 6895480 -\u003e 1000993, 6831632 -\u003e 1246136, 1001719 -\u003e 1009727, 10135633 -\u003e 4250, 7029291 -\u003e 1034635, 6967939 -\u003e 1002734, 6864694 -\u003e 1017311, 1237279 -\u003e 1029..."
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d2",
            "http://172.17.0.2:4040/jobs/job?id\u003d3"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590403815626_-1753499650",
      "id": "20200525-105015_1244952508",
      "dateCreated": "2020-05-25 10:50:15.626",
      "dateStarted": "2020-06-03 10:45:31.446",
      "dateFinished": "2020-06-03 10:45:34.592",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\n\nimport org.apache.spark.sql._\nimport org.apache.spark.broadcast._\n\n// Cleaning data in bonus\n\n/**\n * Convert count musics to approximatively years of listening\n */\ndef countToYear(count: Int): Boolean \u003d {\n    val avgSongMinutesLength \u003d 4.0\n    avgSongMinutesLength * count.toDouble / 60.0 / 24.0 / 365.0 \u003c 2\n}\n \ndef buildCounts(rawUserArtistData: Dataset[String], bArtistAlias: Broadcast[Map[Int,Int]]): DataFrame \u003d {\n    val unknownId \u003d artistByID.filter($\"name\" \u003d\u003d\u003d \"[unknown]\").select($\"id\").head.getInt(0)\n    val userArtistCleanedDF \u003d userArtistDF.filter($\"artist\" !\u003d\u003d unknownId)\n    \n    rawUserArtistData.map { line \u003d\u003e\n        val Array(userID, artistID, count) \u003d line.split(\u0027 \u0027).map(_.toInt)\n        val finalArtistID \u003d bArtistAlias.value.getOrElse(artistID, artistID)\n        (userID, finalArtistID, count)\n    }.toDF(\"user\", \"artist\", \"count\").filter($\"artist\" !\u003d\u003d unknownId)\n}\nval bArtistAlias \u003d spark.sparkContext.broadcast(artistAlias)\nval trainData \u003d buildCounts(rawUserArtistData, bArtistAlias).filter($\"count\" \u003c 400000)\ntrainData.orderBy(desc(\"count\")).show\ntrainData.cache()",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:45:34.644",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "warning: there were two deprecation warnings; re-run with -deprecation for details\n+-------+-------+------+\n|   user| artist| count|\n+-------+-------+------+\n|1059637|1026440|155895|\n|2069889|1002095|101076|\n|2020513|1007801| 88908|\n|1073421|1004440| 67548|\n|2023977|1007903| 62815|\n|2023977|   2823| 51039|\n|2014936|     82| 36083|\n|2069337|1006134| 34800|\n|2013784|1004059| 32768|\n|2069337|1007027| 31321|\n|1073435|1105069| 30043|\n|2023977|1000156| 29983|\n|1052225|1256375| 29933|\n|2017397|1000427| 26394|\n|1045479|1000113| 26135|\n|2062243|6901343| 26107|\n|1039100|1275996| 25858|\n|1053554|    478| 25303|\n|2017397|1004296| 24876|\n|2216281|   5705| 24067|\n+-------+-------+------+\nonly showing top 20 rows\n\nimport org.apache.spark.sql._\nimport org.apache.spark.broadcast._\ncountToYear: (count: Int)Boolean\nbuildCounts: (rawUserArtistData: org.apache.spark.sql.Dataset[String], bArtistAlias: org.apache.spark.broadcast.Broadcast[Map[Int,Int]])org.apache.spark.sql.DataFrame\nbArtistAlias: org.apache.spark.broadcast.Broadcast[scala.collection.immutable.Map[Int,Int]] \u003d Broadcast(9)\ntrainData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [user: int, artist: int ... 1 more field]\nres3: trainData.type \u003d [user: int, artist: int ... 1 more field]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d4",
            "http://172.17.0.2:4040/jobs/job?id\u003d5"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590404829942_-1453554254",
      "id": "20200525-110709_1785781047",
      "dateCreated": "2020-05-25 11:07:09.942",
      "dateStarted": "2020-06-03 10:45:34.682",
      "dateFinished": "2020-06-03 10:46:00.817",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Statistics",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:46:00.900",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eStatistics\u003c/h1\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590414919792_1966495056",
      "id": "20200525-135519_1912337093",
      "dateCreated": "2020-05-25 13:55:19.792",
      "dateStarted": "2020-06-03 10:46:00.931",
      "dateFinished": "2020-06-03 10:46:00.935",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Describe statistics",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:46:01.030",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eDescribe statistics\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590590237186_-623096228",
      "id": "20200527-143717_23609195",
      "dateCreated": "2020-05-27 14:37:17.186",
      "dateStarted": "2020-06-03 10:46:01.070",
      "dateFinished": "2020-06-03 10:46:01.080",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval userSummary \u003d trainData.describe(\"user\")\nuserSummary.show\n\nval artistSummary \u003d trainData.describe(\"artist\")\nartistSummary.show\n\nval countSummary \u003d trainData.describe(\"count\")\ncountSummary.show",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:46:01.169",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+\n|summary|              user|\n+-------+------------------+\n|  count|          24259165|\n|   mean|1947645.8761629264|\n| stddev| 495961.5513546217|\n|    min|                90|\n|    max|           2443548|\n+-------+------------------+\n\n+-------+------------------+\n|summary|            artist|\n+-------+------------------+\n|  count|          24259165|\n|   mean|1701022.6841495163|\n| stddev|  2516504.31072957|\n|    min|                 1|\n|    max|          10794401|\n+-------+------------------+\n\n+-------+------------------+\n|summary|             count|\n+-------+------------------+\n|  count|          24259165|\n|   mean|15.265846577984032|\n| stddev| 89.56463917606709|\n|    min|                 1|\n|    max|            155895|\n+-------+------------------+\n\nuserSummary: org.apache.spark.sql.DataFrame \u003d [summary: string, user: string]\nartistSummary: org.apache.spark.sql.DataFrame \u003d [summary: string, artist: string]\ncountSummary: org.apache.spark.sql.DataFrame \u003d [summary: string, count: string]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d6",
            "http://172.17.0.2:4040/jobs/job?id\u003d7",
            "http://172.17.0.2:4040/jobs/job?id\u003d8"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590590249472_873829545",
      "id": "20200527-143729_1355604663",
      "dateCreated": "2020-05-27 14:37:29.472",
      "dateStarted": "2020-06-03 10:46:01.205",
      "dateFinished": "2020-06-03 10:46:44.747",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Data fusion\nCompute a Dataframe with user id, artist id, artist name and count for later uses.",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:46:44.837",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eData fusion\u003c/h2\u003e\n\u003cp\u003eCompute a Dataframe with user id, artist id, artist name and count for later uses.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590594064315_1755221963",
      "id": "20200527-154104_1970292027",
      "dateCreated": "2020-05-27 15:41:04.315",
      "dateStarted": "2020-06-03 10:46:44.867",
      "dateFinished": "2020-06-03 10:46:44.881",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval userArtistNamesCountDF \u003d \n    trainData\n    .join(artistByID, artistByID(\"id\") \u003d\u003d\u003d trainData(\"artist\"))\n    .select(\"user\", \"artist\", \"name\", \"count\")\nuserArtistNamesCountDF.cache\nuserArtistNamesCountDF.show",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:46:44.967",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------+----------+-----+\n|   user|artist|      name|count|\n+-------+------+----------+-----+\n|1000019|   463|The Smiths|    1|\n|1000020|   463|The Smiths|  199|\n|1000022|   463|The Smiths|   20|\n|1000033|   463|The Smiths|  466|\n|1000056|   463|The Smiths|   10|\n|1000067|   463|The Smiths|   18|\n|1000070|   463|The Smiths|  399|\n|1000073|   463|The Smiths|    3|\n|1000077|   463|The Smiths|   15|\n|1000082|   463|The Smiths|   16|\n|1000090|   463|The Smiths|    1|\n|1000096|   463|The Smiths|    2|\n|1000099|   463|The Smiths|   10|\n|1000106|   463|The Smiths|    1|\n|1000114|   463|The Smiths|    3|\n|1000117|   463|The Smiths|    1|\n|1000119|   463|The Smiths|   14|\n|1000124|   463|The Smiths|    2|\n|1000125|   463|The Smiths|    8|\n|1000127|   463|The Smiths|    2|\n+-------+------+----------+-----+\nonly showing top 20 rows\n\nuserArtistNamesCountDF: org.apache.spark.sql.DataFrame \u003d [user: int, artist: int ... 2 more fields]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d9"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590590062800_2109207725",
      "id": "20200527-143422_594483041",
      "dateCreated": "2020-05-27 14:34:22.800",
      "dateStarted": "2020-06-03 10:46:45.010",
      "dateFinished": "2020-06-03 10:46:54.978",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Around users",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 12:34:15.273",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eAround users\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1591187646397_321240090",
      "id": "20200603-123406_1776470630",
      "dateCreated": "2020-06-03 12:34:06.397",
      "dateStarted": "2020-06-03 12:34:15.274",
      "dateFinished": "2020-06-03 12:34:15.277",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nGet users number",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:46:55.016",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eGet users number\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590747813508_-1257535935",
      "id": "20200529-102333_1988446988",
      "dateCreated": "2020-05-29 10:23:33.508",
      "dateStarted": "2020-06-03 10:46:55.064",
      "dateFinished": "2020-06-03 10:46:55.067",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval distinctUsersNumber \u003d userArtistNamesCountDF.select(\"user\").distinct.count\nprintln(distinctUsersNumber)",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:46:55.163",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "148077\ndistinctUsersNumber: Long \u003d 148077\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d10"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590747828635_-1911174006",
      "id": "20200529-102348_186273132",
      "dateCreated": "2020-05-29 10:23:48.636",
      "dateStarted": "2020-06-03 10:46:55.204",
      "dateFinished": "2020-06-03 10:47:39.179",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nLet\u0027s see the listen\u0027s total per user and sort it by the higher.",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 12:55:42.799",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eLet\u0026rsquo;s see the listen\u0026rsquo;s total per user and sort it by the higher.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1591188912275_1259738258",
      "id": "20200603-125512_896180722",
      "dateCreated": "2020-06-03 12:55:12.275",
      "dateStarted": "2020-06-03 12:55:42.799",
      "dateFinished": "2020-06-03 12:55:42.803",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval userListenArtists \u003d userArtistNamesCountDF.groupBy(\"user\").sum(\"count\").select($\"user\", $\"sum(count)\" as \"total\")\nlistenedArtistsDF.cache\n\nval mostUserListenArtists \u003d userListenArtists.sort(desc(\"total\"))\nmostUserListenArtists.show\n\nz.show()",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 13:15:42.116",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "1": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "user": "string",
                      "total": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "stacked": true
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "user",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "total",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------+\n|   user| total|\n+-------+------+\n|2069337|393515|\n|2023977|285978|\n|1059637|241350|\n|1046559|183972|\n|1052461|175822|\n|1070932|168977|\n|1031009|167028|\n|2020513|165642|\n|2062243|151482|\n|2069889|143092|\n|1001440|136266|\n|2014936|135235|\n|2017397|134032|\n|1024631|122303|\n|1007308|111274|\n|2064012|108640|\n|2023742|102030|\n|1058890| 98472|\n|1021940| 97318|\n|1059245| 96037|\n+-------+------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "user\ttotal\n2069337\t393515\n2023977\t285978\n1059637\t241350\n1046559\t183972\n1052461\t175822\n1070932\t168977\n1031009\t167028\n2020513\t165642\n2062243\t151482\n2069889\t143092\n1001440\t136266\n2014936\t135235\n2017397\t134032\n1024631\t122303\n1007308\t111274\n2064012\t108640\n2023742\t102030\n1058890\t98472\n1021940\t97318\n1059245\t96037\n1070641\t93444\n2070757\t91752\n2288164\t91125\n1009943\t85390\n1063644\t83369\n2000668\t82360\n1048402\t81826\n1047812\t81714\n1017610\t80707\n2023686\t80476\n1059334\t80122\n2007381\t79581\n2030069\t77958\n1052054\t77802\n2010008\t77721\n1073421\t77485\n1072684\t76681\n1059765\t76062\n1076906\t75961\n1035511\t75741\n1026084\t75277\n2005710\t74949\n2010581\t74885\n1000647\t74024\n1042223\t73973\n1029563\t73685\n1055449\t73484\n1021501\t73314\n1041919\t73019\n2102019\t72855\n2005779\t72658\n1003806\t72625\n1061830\t72525\n1021441\t72333\n1022223\t72083\n1026119\t70679\n1004028\t70331\n2039243\t69560\n1054006\t69396\n2013900\t69120\n1039876\t68341\n2017396\t68295\n2040944\t67647\n2006262\t67160\n1049310\t66670\n1067352\t66468\n1054960\t65711\n1070811\t65589\n1023797\t64770\n1003082\t64242\n1060615\t64122\n1041241\t64013\n1006530\t63741\n1026495\t63419\n1058914\t62985\n1000764\t62419\n1020985\t62246\n1064240\t61862\n2007573\t61786\n1063056\t61427\n1024420\t61290\n1041823\t61215\n2024005\t60772\n1010307\t60651\n2004899\t60140\n2120416\t59991\n1000932\t59631\n1077252\t59273\n1071998\t59135\n2016026\t58967\n1015748\t58839\n2050254\t58524\n1043751\t58365\n1073896\t58219\n2008108\t57940\n1047972\t57541\n2012505\t57524\n2040803\t57436\n2019990\t57291\n2054778\t56856\n1039116\t56854\n1060952\t56839\n2057914\t56718\n1038029\t56578\n1037825\t55523\n1041615\t55479\n2041536\t55439\n1024743\t55222\n2015363\t54872\n2016547\t54531\n2066287\t54519\n1044496\t54378\n2011215\t54369\n1056317\t54258\n1007372\t54222\n1049114\t54200\n1045125\t54144\n2013574\t54094\n1044648\t54061\n1000197\t54048\n2015419\t53933\n1062095\t53922\n2014339\t53575\n1030769\t53374\n2033901\t53300\n1042115\t53299\n1045464\t53171\n2019859\t52923\n2101646\t52867\n2036201\t52836\n2070559\t52708\n1062331\t52488\n1066718\t52307\n2073857\t52175\n2017148\t52003\n1054290\t51993\n1031403\t51851\n1061070\t51828\n1070439\t51821\n2010971\t51800\n2083814\t51750\n2066966\t51533\n1045293\t51509\n2027044\t51329\n1061226\t51117\n1058675\t51043\n1062802\t50832\n1039100\t50443\n1005852\t50380\n2030923\t50293\n1067482\t50081\n1040331\t49746\n1052234\t49746\n1021626\t49738\n2008619\t49453\n1039264\t49283\n2169016\t49266\n1064127\t49188\n1045479\t49039\n1003268\t49010\n1060352\t48871\n1049948\t48845\n1073340\t48794\n1069941\t48671\n2034492\t48638\n2260402\t48322\n1025800\t48320\n2019291\t48284\n2005262\t48246\n1031965\t48243\n2024255\t48064\n2058707\t48048\n1049861\t48043\n2071666\t48010\n1001535\t47910\n2109964\t47828\n1073616\t47781\n2004698\t47650\n1072273\t47643\n2008397\t47478\n1061434\t47473\n1002511\t47253\n2005539\t47236\n2077476\t47193\n1022903\t47125\n1051369\t47104\n1051794\t47090\n1039276\t47086\n1049342\t47022\n2034978\t46991\n1038490\t46793\n1004646\t46714\n1053461\t46585\n2024822\t46440\n1024554\t46385\n2024408\t46354\n1013013\t46282\n1071922\t46179\n1047618\t46071\n1049975\t46068\n2005320\t45984\n1005353\t45931\n2077359\t45908\n2033635\t45906\n2298756\t45380\n1005409\t45293\n2076618\t45235\n1008266\t45203\n1052906\t44869\n2072858\t44830\n2153382\t44804\n2010756\t44706\n1054893\t44655\n2025154\t44573\n1040317\t44470\n1037240\t44294\n2005518\t44002\n1060179\t43957\n1048804\t43948\n2083163\t43888\n2027626\t43877\n1034944\t43854\n1036787\t43813\n1041591\t43763\n1008311\t43753\n2051575\t43750\n2072248\t43647\n1040783\t43643\n1001190\t43595\n2083483\t43594\n2150071\t43588\n1034042\t43504\n1005076\t43417\n1052650\t43409\n2037192\t43382\n1052225\t43381\n1035088\t43284\n1003441\t43231\n1039498\t43125\n1025857\t43068\n2017087\t43044\n2050912\t42996\n2081588\t42786\n2035786\t42705\n1068617\t42611\n2048309\t42535\n2165315\t42526\n2016468\t42492\n2134296\t42448\n1068260\t42397\n1021999\t42341\n1064902\t42227\n2112741\t42190\n1070159\t42140\n2005333\t42081\n2160374\t42058\n1004259\t41998\n2004408\t41983\n1071527\t41893\n1027034\t41846\n2066194\t41832\n2012140\t41809\n2113893\t41758\n1038826\t41605\n1072841\t41536\n1052108\t41526\n2013123\t41404\n1030652\t41399\n2133975\t41277\n2066854\t41224\n1058160\t41216\n1027457\t41083\n1001867\t41082\n1044094\t40888\n1000611\t40768\n1055088\t40760\n2043442\t40708\n2002244\t40686\n2064988\t40644\n1074655\t40613\n1026410\t40548\n2006109\t40535\n2031907\t40431\n2006426\t40401\n2083596\t40274\n2050881\t40227\n2060709\t40194\n1064212\t40143\n2081230\t40056\n2173451\t39943\n2010247\t39913\n2039411\t39850\n1058932\t39788\n1055720\t39703\n1046976\t39679\n2004799\t39639\n2086971\t39634\n1063393\t39591\n1059284\t39567\n1017542\t39540\n2106248\t39510\n2109550\t39403\n1008812\t39259\n2033045\t39258\n1073095\t39234\n2114145\t39158\n2036122\t39124\n1021239\t39019\n2019913\t39008\n2144916\t38987\n7585\t38963\n1066687\t38875\n1039318\t38863\n2145918\t38842\n1029545\t38796\n2017834\t38756\n2030691\t38729\n1056255\t38714\n2032949\t38692\n1023863\t38615\n1062485\t38613\n2071103\t38566\n1036986\t38530\n1036940\t38507\n2160109\t38459\n1046062\t38452\n1064077\t38378\n1043983\t38376\n1000288\t38376\n2010445\t38302\n1053554\t38224\n1021549\t38181\n1042923\t38170\n1001562\t38112\n2053182\t38060\n1053908\t37972\n1063879\t37967\n2006239\t37922\n1049203\t37891\n2068088\t37859\n2016128\t37854\n2113918\t37850\n2116258\t37813\n1071105\t37771\n1069977\t37722\n2050310\t37719\n2060980\t37671\n1064060\t37607\n2043021\t37554\n1058542\t37448\n1063153\t37391\n1001118\t37314\n2187732\t37262\n2016686\t37253\n1044992\t37163\n2060832\t37161\n2237492\t37104\n2042801\t37086\n1025770\t37023\n1062748\t37004\n2086125\t36958\n2089838\t36944\n1059592\t36927\n1010131\t36918\n2036998\t36899\n2072296\t36890\n2008305\t36877\n2049652\t36870\n2049131\t36851\n1024369\t36841\n1052637\t36834\n2072222\t36806\n2085558\t36779\n2116356\t36755\n1058293\t36751\n1067960\t36738\n1066803\t36726\n1040093\t36694\n2283682\t36664\n1071846\t36640\n1007409\t36609\n2032004\t36606\n1060725\t36549\n2181569\t36477\n1037823\t36475\n2153647\t36457\n1006478\t36432\n1049494\t36391\n2014644\t36362\n1055268\t36261\n1018761\t36238\n2175863\t36237\n1037282\t36198\n1046116\t36106\n1027420\t36098\n2131971\t36094\n2147461\t36080\n2066332\t36070\n2037319\t36055\n2015276\t36040\n2012544\t36039\n1053427\t36034\n2216329\t36025\n1038035\t35996\n1025790\t35985\n2026580\t35959\n2061557\t35907\n2040815\t35858\n1047668\t35827\n1025828\t35744\n1004213\t35739\n2184924\t35735\n1059833\t35717\n1040132\t35682\n2030867\t35671\n1007092\t35653\n2015928\t35617\n2133916\t35615\n2027551\t35604\n2104631\t35588\n2217230\t35511\n2046099\t35502\n2025300\t35480\n1008050\t35477\n2035266\t35450\n2127969\t35410\n1043686\t35394\n1063488\t35380\n2074604\t35372\n2119871\t35334\n1007512\t35302\n1004584\t35280\n2020632\t35266\n1045481\t35199\n1056789\t35142\n2137140\t35104\n1074846\t35083\n2019544\t35073\n1039284\t35002\n1073038\t34909\n2015371\t34896\n2104830\t34823\n2017719\t34817\n2023036\t34807\n2098685\t34800\n1020308\t34797\n2026348\t34720\n2020205\t34693\n2012128\t34659\n1017287\t34646\n2023038\t34630\n2055705\t34588\n2059878\t34542\n2185290\t34536\n2019884\t34507\n1061471\t34489\n2203078\t34489\n1070844\t34352\n2243168\t34343\n2183497\t34327\n2024962\t34280\n2161809\t34229\n1010068\t34207\n2070886\t34172\n2069081\t34148\n2089368\t34131\n2067332\t34128\n1037666\t34108\n2018101\t34099\n2013784\t34072\n1072865\t34061\n1059198\t34046\n1006121\t34027\n1077099\t34011\n1008730\t34005\n1051276\t34003\n2005645\t33969\n1051908\t33933\n2142559\t33903\n2014225\t33878\n1046217\t33835\n1023639\t33786\n2006013\t33755\n2019752\t33752\n2130928\t33705\n1008438\t33664\n1073435\t33644\n2044879\t33620\n2073882\t33619\n2011153\t33616\n2003704\t33535\n2027509\t33529\n2019928\t33454\n2079179\t33437\n2023584\t33412\n2045199\t33393\n1006472\t33383\n2043178\t33357\n2072389\t33313\n1000248\t33253\n1046577\t33193\n1043122\t33146\n1027403\t33086\n1050974\t33031\n1039362\t33028\n1021124\t32990\n1009606\t32968\n2174953\t32964\n2216281\t32951\n2012182\t32922\n2008442\t32905\n2180727\t32843\n1044694\t32749\n1001310\t32742\n2129561\t32707\n1024606\t32688\n2202950\t32663\n2020786\t32655\n1021112\t32601\n2020386\t32596\n1056439\t32581\n2020216\t32561\n1066703\t32537\n2127432\t32521\n2101672\t32511\n2276357\t32457\n1005841\t32449\n2062410\t32437\n1055778\t32402\n2085319\t32393\n2008390\t32390\n2040288\t32355\n1026880\t32298\n1072252\t32295\n1005635\t32282\n1039207\t32280\n1045014\t32269\n2203045\t32232\n2039069\t32218\n1006561\t32155\n1054862\t32089\n2057590\t32082\n1066327\t32079\n1066575\t32043\n2109302\t32038\n2013651\t32028\n2100800\t32011\n2076566\t31996\n2012261\t31968\n1071035\t31951\n1041679\t31902\n1060908\t31898\n2074889\t31887\n2107471\t31880\n2009373\t31879\n2113742\t31872\n2015138\t31867\n1066208\t31845\n1045621\t31829\n1054347\t31826\n2087072\t31821\n2004750\t31817\n2147387\t31816\n1062330\t31784\n1024605\t31776\n2038335\t31749\n1002222\t31744\n2053517\t31682\n1043605\t31635\n2014273\t31610\n2072249\t31605\n1007564\t31569\n2048316\t31544\n2175533\t31522\n1037974\t31510\n2011243\t31469\n1064207\t31465\n2221949\t31443\n1052037\t31395\n2147072\t31392\n2035204\t31390\n1060644\t31384\n2020277\t31374\n2294923\t31367\n2015804\t31320\n2035525\t31211\n1043737\t31184\n1000199\t31183\n1077362\t31161\n2078417\t31160\n2070264\t31156\n1049766\t31148\n2224783\t31136\n2043762\t31112\n1071515\t31048\n2139079\t31023\n1055432\t31018\n2160849\t31009\n2023125\t30985\n1073226\t30972\n2147884\t30955\n2144492\t30917\n2062390\t30899\n1037162\t30885\n1005985\t30876\n2076207\t30812\n2067296\t30811\n1064168\t30809\n2176786\t30800\n2062368\t30795\n1067952\t30793\n2012806\t30792\n2080016\t30783\n1070318\t30779\n2089146\t30778\n1040536\t30776\n2222692\t30776\n2075471\t30770\n2121203\t30751\n2197018\t30748\n2079933\t30746\n1057054\t30667\n2135599\t30658\n2020477\t30651\n2005921\t30650\n2087257\t30643\n2056340\t30609\n2257599\t30596\n1044015\t30573\n2177651\t30571\n2100694\t30561\n1051353\t30496\n2069411\t30473\n1038950\t30473\n2051766\t30471\n2002221\t30440\n2043361\t30434\n1051568\t30425\n1055735\t30404\n1063407\t30397\n2045348\t30388\n2013192\t30386\n2062584\t30366\n1016462\t30317\n2009432\t30317\n1049160\t30315\n1069913\t30288\n1007801\t30260\n1044891\t30259\n1062222\t30249\n2254727\t30242\n2214962\t30225\n1055807\t30203\n2123154\t30188\n1004971\t30187\n1000098\t30166\n2004448\t30155\n1065897\t30132\n1001223\t30077\n1053245\t30073\n1000190\t30056\n2056211\t30046\n2131326\t30041\n2021433\t30028\n2135758\t30022\n1009580\t30019\n2050763\t30019\n1020357\t30012\n1039855\t30012\n2105914\t30007\n1029678\t29998\n1021574\t29998\n1070518\t29936\n1036634\t29903\n1045501\t29890\n2161595\t29842\n1037344\t29840\n2065550\t29839\n1059315\t29828\n2023197\t29778\n1056559\t29776\n2193127\t29750\n2241032\t29743\n2189399\t29720\n1016665\t29717\n2222719\t29713\n2063453\t29703\n1040284\t29700\n1005959\t29689\n1021470\t29689\n1044283\t29680\n2015796\t29665\n1023016\t29638\n2043566\t29619\n2011144\t29618\n2178742\t29596\n1035021\t29529\n1047127\t29528\n2005910\t29505\n2096691\t29489\n1003017\t29475\n1073236\t29448\n2023179\t29435\n1074392\t29417\n2204589\t29361\n1000968\t29335\n1039908\t29311\n1027030\t29299\n1043557\t29282\n1039614\t29229\n1041044\t29222\n1055656\t29220\n1045315\t29218\n2015436\t29213\n1044767\t29196\n2084673\t29196\n2047531\t29175\n2200013\t29167\n2101817\t29158\n2004958\t29143\n2023736\t29113\n2114237\t29103\n1037443\t29094\n2026201\t29077\n2287095\t29069\n2084510\t29065\n2293601\t29061\n1067080\t29029\n1048161\t29028\n2078827\t29010\n2183447\t29008\n1056318\t29000\n1038770\t28986\n2124523\t28969\n1005622\t28951\n1059305\t28936\n2241456\t28908\n2057889\t28903\n2164727\t28863\n2108768\t28839\n1050213\t28826\n1051866\t28825\n2132136\t28796\n2209396\t28781\n2020120\t28772\n2128360\t28770\n1003655\t28769\n1050873\t28736\n1038421\t28730\n2006283\t28704\n1048953\t28682\n2098536\t28662\n1000555\t28659\n1001307\t28657\n2012582\t28654\n1046442\t28634\n581\t28630\n2260819\t28616\n2059627\t28599\n1021507\t28589\n2147630\t28573\n2073364\t28567\n2058161\t28554\n2048673\t28552\n1003731\t28548\n1052884\t28547\n2250782\t28542\n2011487\t28542\n1055194\t28511\n1060655\t28505\n1002624\t28501\n2094925\t28492\n2036959\t28482\n1026529\t28447\n2043927\t28398\n2039561\t28395\n2185418\t28327\n2159149\t28287\n1037947\t28278\n1021541\t28274\n2201328\t28268\n2076624\t28253\n2203300\t28234\n1038870\t28147\n2128545\t28141\n1044231\t28137\n2231396\t28126\n2244606\t28110\n1072133\t28104\n2109951\t28084\n1016152\t28061\n2047506\t28054\n2165453\t28051\n1064510\t28040\n2035051\t28039\n2098726\t28028\n1001777\t28027\n2157954\t28024\n2128081\t28015\n2070081\t28013\n1046081\t28009\n1059295\t27990\n1071451\t27977\n2207460\t27960\n1001070\t27910\n1003451\t27901\n2017438\t27889\n2037533\t27888\n2009719\t27838\n2063267\t27808\n2011129\t27797\n2020506\t27791\n2303980\t27791\n2088711\t27776\n2214656\t27730\n1063022\t27714\n1053832\t27693\n1002167\t27676\n2042518\t27671\n2124394\t27629\n1051518\t27627\n2020246\t27615\n2078421\t27591\n1070514\t27590\n1003319\t27554\n2030187\t27551\n1071787\t27454\n1042684\t27440\n1021886\t27436\n2076956\t27424\n1056373\t27401\n2015671\t27383\n2240590\t27383\n1058596\t27380\n2023734\t27350\n2074380\t27349\n2117924\t27340\n1006069\t27331\n2015662\t27329\n2186155\t27315\n2108179\t27313\n1067697\t27304\n2048942\t27286\n2045396\t27283\n1056506\t27279\n2048332\t27270\n1054047\t27259\n2128302\t27207\n2056471\t27203\n2253457\t27144\n1008083\t27108\n2048229\t27063\n1021843\t27043\n2179401\t27042\n2088179\t27035\n1000769\t27026\n2018618\t26999\n2035486\t26982\n2038737\t26977\n1070058\t26961\n1038197\t26928\n2158512\t26906\n1052236\t26901\n1064253\t26898\n1009320\t26866\n2151591\t26842\n2207687\t26840\n1020855\t26811\n1049472\t26807\n1061950\t26806\n2214888\t26805\n2136556\t26802\n2002031\t26790\n2225341\t26777\n2078960\t26771\n2086593\t26756\n1006903\t26753\n1001220\t26749\n2047696\t26738\n1017881\t26724\n2019951\t26677\n2079939\t26672\n1030469\t26666\n2234124\t26656\n2035606\t26650\n2094539\t26639\n2072242\t26603\n2220548\t26595\n2018033\t26563\n2009749\t26545\n1043564\t26542\n2005106\t26529\n2135742\t26528\n2028728\t26508\n1068356\t26495\n2008303\t26493\n2188858\t26468\n2033391\t26450\n1048750\t26448\n1053763\t26446\n2107316\t26416\n1044540\t26414\n2041212\t26397\n2006498\t26362\n1066241\t26331\n2010523\t26325\n2074083\t26325\n2216992\t26316\n1020881\t26314\n1072997\t26303\n1044422\t26303\n2203600\t26297\n2058087\t26282\n1052410\t26277\n2033419\t26191\n1002830\t26186\n1043734\t26129\n1026047\t26125\n2021010\t26096\n2035403\t26084\n2176615\t26052\n1053325\t26050\n1052028\t26032\n1052978\t26031\n2162891\t26024\n2026960\t26008\n2186230\t26006\n1054663\t25983\n1063064\t25980\n1021966\t25974\n1044528\t25949\n2006427\t25948\n2006092\t25931\n1003589\t25930\n2006093\t25912\n1054650\t25908\n1039416\t25905\n2057876\t25899\n1009926\t25887\n2033292\t25883\n1037302\t25876\n1027331\t25876\n2004719\t25856\n2005117\t25820\n2066418\t25818\n2267709\t25814\n2299954\t25805\n2041261\t25795\n1077262\t25794\n1001746\t25770\n2069413\t25762\n2067636\t25757\n1070872\t25747\n1038435\t25741\n2015788\t25721\n1021923\t25718\n1039322\t25712\n2133873\t25708\n2023399\t25702\n1043521\t25690\n1038380\t25674\n2036697\t25669\n1005975\t25668\n2067264\t25645\n2030377\t25641\n2020472\t25626\n1058776\t25624\n2202279\t25610\n2110860\t25594\n1060074\t25579\n1009813\t25578\n1031916\t25568\n1063125\t25568\n1065971\t25559\n1000454\t25536\n1037848\t25532\n2103228\t25528\n1073439\t25522\n2021126\t25517\n2002976\t25482\n1070732\t25476\n2008698\t25470\n1064059\t25462\n2117355\t25450\n2268277\t25440\n2093052\t25437\n1039020\t25427\n2023287\t25403\n2012593\t25382\n1031338\t25371\n1002165\t25367\n2199359\t25343\n1043283\t25338\n2092405\t25336\n1073342\t25329\n1001905\t25329\n1045559\t25321\n8492\t25321\n2067899\t25320\n2066847\t25319\n"
          },
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"result-alert alert-warning\" role\u003d\"alert\"\u003e\u003cbutton type\u003d\"button\" class\u003d\"close\" data-dismiss\u003d\"alert\" aria-label\u003d\"Close\"\u003e\u003cspan aria-hidden\u003d\"true\"\u003e\u0026times;\u003c/span\u003e\u003c/button\u003e\u003cstrong\u003eOutput is truncated\u003c/strong\u003e to 1000 rows. Learn more about \u003cstrong\u003ezeppelin.spark.maxResult\u003c/strong\u003e\u003c/div\u003e\n"
          },
          {
            "type": "TEXT",
            "data": "userListenArtists: org.apache.spark.sql.DataFrame \u003d [user: int, total: bigint]\nmostUserListenArtists: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [user: int, total: bigint]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d55",
            "http://172.17.0.2:4040/jobs/job?id\u003d56"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1591187663060_-889404448",
      "id": "20200603-123423_567139667",
      "dateCreated": "2020-06-03 12:34:23.060",
      "dateStarted": "2020-06-03 13:12:24.576",
      "dateFinished": "2020-06-03 13:13:11.405",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nThe first user made almost 400\u0027000 plays !\nWe can see that a user has listend \"My Chemical Romance\" almost 156\u0027000 times.",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 14:38:41.583",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eThe first user made almost 400\u0026rsquo;000 plays !\u003cbr/\u003eWe can see that a user has listend \u0026ldquo;My Chemical Romance\u0026rdquo; almost 156\u0026rsquo;000 times.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1591188952139_313158455",
      "id": "20200603-125552_1479982108",
      "dateCreated": "2020-06-03 12:55:52.139",
      "dateStarted": "2020-06-03 14:38:41.584",
      "dateFinished": "2020-06-03 14:38:41.587",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval userDifferentArtists \u003d userArtistNamesCountDF.groupBy(\"user\", \"name\").sum(\"count\").select($\"user\", $\"name\", $\"sum(count)\" as \"total\")\nuserDifferentArtists.cache\nuserDifferentArtists.sort(desc(\"total\")).show",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 14:01:37.269",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------+------+\n|   user|                name| total|\n+-------+--------------------+------+\n|1059637| My Chemical Romance|155895|\n|2069889| Something Corporate|101076|\n|2020513|      Mates of State| 89592|\n|1073421|    Guided by Voices| 67548|\n|2023977|            Maroon 5| 62815|\n|2023977|   Alanis Morissette| 51039|\n|2014936|          Pink Floyd| 36083|\n|2069337|        Sage Francis| 34800|\n|2013784|     Cannibal Corpse| 32768|\n|2069337|          Jawbreaker| 31321|\n|1073435|ASIAN KUNG-FU GEN...| 30043|\n|2023977|          Guano Apes| 29983|\n|1052225|               | 29933|\n|2017397|     New Found Glory| 26394|\n|1045479|         The Beatles| 26135|\n|2062243|           Music 205| 26107|\n|1039100|              R.E.M.| 25858|\n|1053554|    Boards of Canada| 25303|\n|2017397|              Thrice| 24876|\n|2216281|           Rammstein| 24067|\n+-------+--------------------+------+\nonly showing top 20 rows\n\nuserDifferentArtists: org.apache.spark.sql.DataFrame \u003d [user: int, name: string ... 1 more field]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d77"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1591189886953_-1586584012",
      "id": "20200603-131126_294603452",
      "dateCreated": "2020-06-03 13:11:26.953",
      "dateStarted": "2020-06-03 13:59:52.318",
      "dateFinished": "2020-06-03 14:00:00.585",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nNow let\u0027s see how many different artists the users listen in average.",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 14:37:53.385",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eNow let\u0026rsquo;s see how many different artists the users listen in average.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1591195070440_23860404",
      "id": "20200603-143750_192146411",
      "dateCreated": "2020-06-03 14:37:50.440",
      "dateStarted": "2020-06-03 14:37:53.386",
      "dateFinished": "2020-06-03 14:37:53.388",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval artistsPerUser \u003d userDifferentArtists.groupBy(\"user\").count.sort(desc(\"count\"))\nartistsPerUser.cache\n\nprintln(artistsPerUser.count)\nartistsPerUser.describe(\"count\").show",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 14:37:20.259",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "148077\n+-------+------------------+\n|summary|             count|\n+-------+------------------+\n|  count|            148077|\n|   mean|162.66439757693632|\n| stddev|215.38131877586378|\n|    min|                 1|\n|    max|              6734|\n+-------+------------------+\n\nartistsPerUser: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [user: int, count: bigint]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d114",
            "http://172.17.0.2:4040/jobs/job?id\u003d115"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1591192747866_1333042132",
      "id": "20200603-135907_210380760",
      "dateCreated": "2020-06-03 13:59:07.866",
      "dateStarted": "2020-06-03 14:37:20.295",
      "dateFinished": "2020-06-03 14:37:22.404",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nUsers listen to 162 artists in average.\n",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 14:39:26.759",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eUsers listen to 162 artists in average.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1591195139834_1725271268",
      "id": "20200603-143859_2131322575",
      "dateCreated": "2020-06-03 14:38:59.834",
      "dateStarted": "2020-06-03 14:39:26.760",
      "dateFinished": "2020-06-03 14:39:26.765",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Around artists",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 12:33:51.902",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eAround artists\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590589883731_1756040608",
      "id": "20200527-143123_948169887",
      "dateCreated": "2020-05-27 14:31:23.731",
      "dateStarted": "2020-06-03 12:33:51.903",
      "dateFinished": "2020-06-03 12:33:51.906",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nGet artists number",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:47:39.255",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eGet artists number\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590747661487_613552488",
      "id": "20200529-102101_551270995",
      "dateCreated": "2020-05-29 10:21:01.487",
      "dateStarted": "2020-06-03 10:47:39.283",
      "dateFinished": "2020-06-03 10:47:39.288",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval distinctArtistsNumber \u003d userArtistNamesCountDF.select(\"artist\").distinct.count\nprintln(distinctArtistsNumber)",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:47:39.383",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "1554191\ndistinctArtistsNumber: Long \u003d 1554191\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d11"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590747287371_1343407231",
      "id": "20200529-101447_1422946071",
      "dateCreated": "2020-05-29 10:14:47.371",
      "dateStarted": "2020-06-03 10:47:39.416",
      "dateFinished": "2020-06-03 10:47:42.749",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nGet the total amount music listened for each artist and most listened artists.",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 12:33:41.927",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eGet the total amount music listened for each artist and most listened artists.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1591187513078_516772673",
      "id": "20200603-123153_1820679292",
      "dateCreated": "2020-06-03 12:31:53.078",
      "dateStarted": "2020-06-03 12:33:41.928",
      "dateFinished": "2020-06-03 12:33:41.931",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval listenedArtistsDF \u003d userArtistNamesCountDF.groupBy(\"name\").sum(\"count\").select($\"name\", $\"sum(count)\" as \"total\")\nlistenedArtistsDF.cache\n\nval mostListenedArtistsDF \u003d listenedArtistsDF.sort(desc(\"total\"))\nmostListenedArtistsDF.show",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:47:42.955",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+-------+\n|                name|  total|\n+--------------------+-------+\n|           Radiohead|2502596|\n|         The Beatles|2259825|\n|           Green Day|1931143|\n|           Metallica|1543430|\n|          Pink Floyd|1399665|\n|     Nine Inch Nails|1361977|\n|        Modest Mouse|1328969|\n|         Bright Eyes|1234773|\n|             Nirvana|1203348|\n|                Muse|1148684|\n| Death Cab for Cutie|1117277|\n|Red Hot Chili Pep...|1088701|\n|       Elliott Smith|1080542|\n|           Rammstein|1047119|\n|         Linkin Park|1028921|\n|                  U2|1015494|\n|           Nightwish|1010869|\n|            Coldplay|1001417|\n|    System of a Down| 986483|\n|            Interpol| 979770|\n+--------------------+-------+\nonly showing top 20 rows\n\nlistenedArtistsDF: org.apache.spark.sql.DataFrame \u003d [name: string, total: bigint]\nmostListenedArtistsDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [name: string, total: bigint]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d12"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590595127492_295793374",
      "id": "20200527-155847_268656697",
      "dateCreated": "2020-05-27 15:58:47.492",
      "dateStarted": "2020-06-03 10:47:42.988",
      "dateFinished": "2020-06-03 10:47:58.255",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nz.show(mostListenedArtistsDF)",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 11:48:00.341",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "name": "string",
                      "total": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "stacked": false
                },
                "stackedAreaChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "name",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "total",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "name\ttotal\nRadiohead\t2502596\nThe Beatles\t2259825\nGreen Day\t1931143\nMetallica\t1543430\nPink Floyd\t1399665\nNine Inch Nails\t1361977\nModest Mouse\t1328969\nBright Eyes\t1234773\nNirvana\t1203348\nMuse\t1148684\nDeath Cab for Cutie\t1117277\nRed Hot Chili Peppers\t1088701\nElliott Smith\t1080542\nRammstein\t1047119\nLinkin Park\t1028921\nU2\t1015494\nNightwish\t1010869\nColdplay\t1001417\nSystem of a Down\t986483\nInterpol\t979770\nWeezer\t977933\nA Perfect Circle\t973730\nThe Smashing Pumpkins\t950683\nLed Zeppelin\t944551\nIncubus\t920733\nBeck\t906699\nThe Cure\t895561\nEminem\t891612\nPixies\t889498\nblink-182\t887007\nThe Postal Service\t885848\nThe Killers\t879764\nTool\t858922\nThe Shins\t846458\nJimmy Eat World\t838323\nMy Chemical Romance\t793719\nIn Flames\t786027\nIron Maiden\t765957\nQueens of the Stone Age\t760121\nR.E.M.\t752743\nQueen\t740877\nFranz Ferdinand\t740594\nDavid Bowie\t722031\nBjrk\t708168\nBelle and Sebastian\t706987\nAir\t689020\nThe Offspring\t682354\nPlacebo\t676059\nThe White Stripes\t671382\nThe Smiths\t670815\nThe Arcade Fire\t669825\nBad Religion\t666645\nKon\t663159\nThe Mars Volta\t660903\nBeastie Boys\t650204\nPearl Jam\t629819\nEvanescence\t626593\nMoby\t622249\nBloc Party\t614742\nJack Johnson\t614735\nBob Dylan\t606271\nOasis\t605582\nMarilyn Manson\t605255\nTori Amos\t603733\nRage Against the Machine\t597351\nDream Theater\t595765\nFoo Fighters\t590075\nDepeche Mode\t585667\nAphex Twin\t571955\nBoards of Canada\t571706\nNOFX\t560297\nThe Decemberists\t559861\nThe Prodigy\t544624\nDashboard Confessional\t535339\nTaking Back Sunday\t534812\nAFI\t526776\nSlipknot\t526622\nGuns N\u0027 Roses\t525885\nBrand New\t506814\nThe Chemical Brothers\t501891\nAlkaline Trio\t501353\nIron \u0026 Wine\t500984\nCake\t497515\nThey Might Be Giants\t497168\nDaft Punk\t496060\nThe Rolling Stones\t492885\nWilco\t491431\nThe Used\t491124\nThe Clash\t489810\nSomething Corporate\t488480\nSublime\t487048\nThe Strokes\t486510\nThe Libertines\t477655\nMaroon 5\t472607\n\t464349\nAC/DC\t463842\nMassive Attack\t459884\nSonata Arctica\t459535\nDave Matthews Band\t457131\nBlur\t450068\nAvril Lavigne\t447088\nMegadeth\t436999\nChildren of Bodom\t432633\nRilo Kiley\t429798\nDeftones\t428818\nJohnny Cash\t428330\n50 Cent\t425818\nGarbage\t423691\nSnow Patrol\t421697\nThe Doors\t418103\nThe Flaming Lips\t415596\nTom Waits\t412769\nAt the Drive-In\t409304\nRamones\t404403\nEels\t399851\nSigur Rs\t399708\nMorrissey\t398493\nOpeth\t396403\n3 Doors Down\t396174\nHiM\t390740\nFall Out Boy\t389757\nJimi Hendrix\t384446\nSum 41\t384176\nOutkast\t379404\nThe Magnetic Fields\t378191\nGorillaz\t376785\nSlayer\t372323\nCounting Crows\t370682\n\t370613\nYellowcard\t366206\nKeane\t365085\nThrice\t364710\nMogwai\t358142\nPavement\t355857\n2Pac\t355221\nThursday\t353443\nThe Faint\t352134\nBen Folds\t351266\nThe Who\t350338\nThe Hives\t348146\n\t343500\nCoheed and Cambria\t342224\nKent\t341506\nJay-Z\t340788\nSimon \u0026 Garfunkel\t339949\nTenacious D\t338125\nDamien Rice\t335079\nNeutral Milk Hotel\t334026\nPortishead\t332766\nBlind Guardian\t331692\nBen Folds Five\t330490\nHot Hot Heat\t330062\nSonic Youth\t326436\nAlice in Chains\t324125\nJoy Division\t323247\nAlanis Morissette\t322949\nNew Order\t322336\nMillencolin\t321727\nWithin Temptation\t320320\nLostprophets\t319959\nNick Drake\t316146\nSufjan Stevens\t315574\nThe Beach Boys\t314187\nGood Charlotte\t313989\nLimp Bizkit\t313761\nThe Blood Brothers\t312682\nNo Doubt\t312466\nLess Than Jake\t311224\nMindless Self Indulgence\t310112\nMisfits\t309837\nPantera\t307386\n311\t306232\nBroken Social Scene\t306054\nThe Streets\t305854\nCursive\t305625\nHoobastank\t304286\nNorah Jones\t302476\nZero 7\t302423\nBlack Sabbath\t301232\nNew Found Glory\t300052\nRancid\t296873\nReel Big Fish\t295462\n...And You Will Know Us by the Trail of Dead\t293959\nPapa Roach\t290971\nThe Velvet Underground\t290072\nSaves the Day\t289459\nThievery Corporation\t288063\nCradle of Filth\t287997\nJeff Buckley\t287971\nApocalyptica\t287776\nBarenaked Ladies\t286466\nJohn Mayer\t286308\nRise Against\t283567\nRyan Adams\t283132\nManic Street Preachers\t280426\nEnya\t277549\nFatboy Slim\t277248\nPJ Harvey\t274109\nBadly Drawn Boy\t273939\nAerosmith\t272992\nFrou Frou\t272246\nAtreyu\t271253\nKanye West\t270496\nBritney Spears\t270454\nPorcupine Tree\t265940\nDJ Shadow\t265742\nFear Factory\t264651\nJudas Priest\t264347\nDir en grey\t263480\nGwen Stefani\t262148\nNeil Young\t261623\nMadonna\t260733\nKillswitch Engage\t260474\nAudioslave\t260409\nFrank Zappa\t258997\nBob Marley\t258667\nDark Tranquillity\t258227\nGuided by Voices\t258033\nYeah Yeah Yeahs\t257221\nMichael Jackson\t256084\nDropkick Murphys\t255779\nKings of Convenience\t255596\nTed Leo and the Pharmacists\t253578\nGoo Goo Dolls\t253474\nThe Ataris\t252961\nNick Cave and the Bad Seeds\t251582\nOf Montreal\t250324\nHoward Shore\t250179\nDisturbed\t250087\nUnderoath\t250027\nRufus Wainwright\t249129\nThe Mountain Goats\t247831\nDie rzte\t246929\nFlogging Molly\t245129\nNas\t244969\nThe Cranberries\t244768\nAni DiFranco\t243955\nScissor Sisters\t242937\nSpoon\t241851\nInfected Mushroom\t241346\nDimmu Borgir\t240912\nLacuna Coil\t240258\nEric Clapton\t239861\nAlexisonfire\t239647\nFaith No More\t239596\nDido\t239502\nDoves\t239374\nTravis\t237749\nMae\t237166\nIced Earth\t236278\nthe pillows\t235701\nRJD2\t233687\nGoldfinger\t233324\nBruce Springsteen\t233273\nThe Get Up Kids\t232946\nFiona Apple\t232092\nM83\t231746\nSoilwork\t231395\nThe Futureheads\t229516\nPinback\t228635\nYann Tiersen\t226879\nASIAN KUNG-FU GENERATION\t225048\nSarah McLachlan\t224569\nLe Tigre\t223805\nThird Eye Blind\t222365\nSnoop Dogg\t221982\nThe Cardigans\t221209\nExplosions in the Sky\t220066\nThe Kinks\t218834\nSoundgarden\t218661\nTalking Heads\t217826\nBlack Eyed Peas\t217273\nRobbie Williams\t216710\nCat Power\t216503\nFrank Sinatra\t214695\nBob Marley \u0026 the Wailers\t214608\nPhish\t213096\nYo La Tengo\t212387\nMotion City Soundtrack\t211939\nVNV Nation\t211118\nFinntroll\t209966\nKings of Leon\t209671\nJamiroquai\t208595\nBush\t208473\nCreedence Clearwater Revival\t207101\nFeeder\t206319\nBuilt to Spill\t205647\nLive\t205352\nStone Temple Pilots\t204370\nThe Dandy Warhols\t204324\nMiles Davis\t204193\nRush\t203117\nJay-Z and Linkin Park\t201424\nDire Straits\t201172\nAtmosphere\t201009\nThe Game\t200288\nElvis Presley\t199904\nAgainst Me!\t199678\nThe Starting Line\t199580\nAnti-Flag\t198679\nStaind\t198578\nMates of State\t198278\nAmon Tobin\t198050\nChevelle\t197682\nKylie Minogue\t196714\nUsher\t196357\nSage Francis\t195825\nAutechre\t195664\nDeath From Above 1979\t195571\nFinch\t195302\nKaiser Chiefs\t194672\nOur Lady Peace\t193816\nJet\t193760\nPrefuse 73\t193394\nSenses Fail\t193021\nOrbital\t192999\nMy Bloody Valentine\t192845\nThe Unicorns\t191902\nAyreon\t191337\nBasement Jaxx\t190770\nElton John\t189574\nSwitchfoot\t189543\nStraylight Run\t189470\nMatchbox Twenty\t189114\nSquarepusher\t188901\nDevendra Banhart\t185991\nGuano Apes\t185850\nJohn Frusciante\t185579\nGuster\t185388\nNickelback\t184901\nAnathema\t183760\nPedro the Lion\t183564\n\t183500\nStatic-X\t183458\nFugazi\t183311\nBilly Joel\t182903\nKatatonia\t182750\nThe Police\t182335\nKMFDM\t182195\nFaithless\t181933\nStereophonics\t181277\nPennywise\t180991\nMudvayne\t180804\nThe Roots\t180373\nBloodhound Gang\t179718\nVan Halen\t179216\nThe Crystal Method\t179007\nAsh\t178993\nSimple Plan\t178297\nMe First and the Gimme Gimmes\t178238\nTherion\t177773\n\"Weird Al\" Yankovic\t177741\nCypress Hill\t177177\nElvis Costello\t177130\nKasabian\t176576\nGrandaddy\t176539\nFuneral for a Friend\t175883\nOzzy Osbourne\t175328\nFrom Autumn to Ashes\t175145\nRhapsody\t175068\nConverge\t175055\nBlonde Redhead\t175000\nMirah\t174273\n\t173340\nKraftwerk\t173148\nThe Fiery Furnaces\t173028\nArch Enemy\t172388\nArmor for Sleep\t171569\nDr. Dre\t171371\nGodsmack\t171047\nJohn Williams\t169904\nLudacris\t169876\nJurassic 5\t169536\nMorcheeba\t168968\nSugarcult\t168884\nStereolab\t167655\nThe Bravery\t167367\nThe Dillinger Escape Plan\t166963\nBon Jovi\t166840\nCopeland\t166397\nJohann Sebastian Bach\t166016\nPulp\t165910\nTegan and Sara\t165894\nStars\t165405\nRazorlight\t165336\nPrimus\t164958\nBreaking Benjamin\t164690\nDeep Purple\t164296\nPrince\t164281\nThe Darkness\t163813\nStratovarius\t163560\nN*E*R*D\t163418\nLow\t163412\nL\u0027Arc~en~Ciel\t163342\nDead Kennedys\t162894\nLifehouse\t162706\nThe Go! Team\t161618\nUnderworld\t161427\nGrateful Dead\t160553\nVelvet Revolver\t159698\nPain of Salvation\t159450\nBrian Eno\t159333\nJoe Satriani\t159069\nThe Weakerthans\t159016\nCKY\t158103\nIdlewild\t157398\nMachine Head\t157046\nSepultura\t155872\nThe Dresden Dolls\t155661\nFour Tet\t155623\n\t155562\nEnigma\t155041\nCreed\t153976\nAesop Rock\t153681\nMetric\t153385\nRob Zombie\t152795\nJethro Tull\t152713\nBowling For Soup\t152606\nScooter\t151995\nStory of the Year\t151680\nLadytron\t151099\nXiu Xiu\t150875\nMotrhead\t149988\nKelly Clarkson\t149718\nPhantom Planet\t149389\nEagles\t149233\nSting\t148989\nAdam Green\t148604\nLeonard Cohen\t148453\nSilverchair\t148373\nQ and Not U\t147691\nJoanna Newsom\t147588\nHelloween\t147343\nGackt\t147029\nSkinny Puppy\t146956\nStevie Wonder\t146910\nDJ Tisto\t146761\nLamb\t146675\nDelerium\t146661\nA Tribe Called Quest\t146651\nRelient K\t146586\nFleetwood Mac\t146562\nBilly Talent\t146371\nNelly\t146327\nWeen\t146065\nDuran Duran\t144936\nDredg\t144851\nMinus The Bear\t144836\nRyksopp\t144359\nEverclear\t144268\nLamb of God\t144117\nAimee Mann\t143696\nGenesis\t142717\nThe New Pornographers\t142678\nMachinae Supremacy\t142173\nSparta\t141495\nTurbonegro\t141320\nBen Harper\t140805\nJohn Lennon\t140370\nParadise Lost\t140132\nBen Kweller\t139794\nMadvillain\t139777\nVan Morrison\t139607\nHammerfall\t139574\nThe Presidents of the United States of America\t139249\nHead Automatica\t138520\nSentenced\t138414\nLagwagon\t138149\nWu-Tang Clan\t137843\nWolfgang Amadeus Mozart\t137568\nThe Microphones\t137139\nThe Books\t137069\nPet Shop Boys\t135833\nPaul Oakenfold\t135491\n:Wumpscut:\t135315\nThe Walkmen\t134439\nLCD Soundsystem\t134422\nVarious Artists\t134053\nCannibal Corpse\t133730\n\t133604\nD12\t133345\nmm\t133265\nManowar\t133169\nLars Winnerbck\t133082\nAlicia Keys\t132485\nThe Notwist\t131827\nBryan Adams\t131671\nCatch 22\t131106\nAnberlin\t131084\nSaosin\t130892\nLenny Kravitz\t130615\nATB\t130471\nJason Mraz\t130386\nPeter Gabriel\t130354\nBoA\t130120\nType O Negative\t130022\nThe Distillers\t129929\nMos Def\t129863\nJedi Mind Tricks\t129788\nMF Doom\t129304\nAkira Yamaoka\t128745\nSuper Furry Animals\t128236\nDavid Gray\t127073\nIsis\t126464\nThe Verve\t126447\nGoldfrapp\t126432\nLudwig van Beethoven\t125610\nThe Album Leaf\t125331\nTV on the Radio\t124129\nBritish Sea Power\t124095\nGroove Armada\t123693\nMxPx\t123173\nThe Early November\t123079\nCMX\t122971\nMichelle Branch\t122801\nGlassjaw\t122689\nRay Charles\t122678\nChristina Aguilera\t122146\nElectric Six\t122103\nMando Diao\t121823\nMeshuggah\t121590\nAmon Amarth\t121280\n36 Crazyfists\t121208\nFantmas\t121051\nCat Stevens\t120904\nMatchbook Romance\t120531\nManu Chao\t120238\nDe La Soul\t120137\nSocial Distortion\t119878\nDie Toten Hosen\t119440\nDispatch\t119423\nAshlee Simpson\t118933\nDead Can Dance\t118636\nThe Vines\t118074\nP.O.D.\t117979\nM. Ward\t117702\nFurther Seems Forever\t117402\nAvenged Sevenfold\t117280\nHans Zimmer\t117155\nDeath\t117137\nGodspeed You! Black Emperor\t116659\nBlondie\t116427\nAdema\t116402\nEisley\t116360\nRefused\t115974\nThe Corrs\t115697\nThe Beta Band\t115537\nCocteau Twins\t115529\nThe Polyphonic Spree\t115471\nSleater-Kinney\t114781\nPoison the Well\t114727\nPatrick Wolf\t114705\nDizzee Rascal\t114527\nDestiny\u0027s Child\t114469\nPhil Collins\t114126\nMariah Carey\t113633\nThe Stone Roses\t113623\nIll Nio\t113499\nUlver\t113211\nHawthorne Heights\t113131\nMr. Bungle\t113062\nKiss\t112919\nThe Bouncing Souls\t112467\nThe Dismemberment Plan\t112075\nYes\t111728\nNotorious B.I.G.\t111485\nCold\t111440\nFountains of Wayne\t111369\nBiffy Clyro\t111320\nMad Caddies\t111081\nEnnio Morricone\t111049\nThree Days Grace\t110764\nThe Juliana Theory\t110657\nPaul Simon\t110644\nFrom First To Last\t110538\nSymphony X\t110514\nClint Mansell\t110354\nPretty Girls Make Graves\t109853\nNada Surf\t109599\nDescendents\t109509\nThe Haunted\t109255\nSneaker Pimps\t109204\nMastodon\t108903\nNelly Furtado\t108874\nThe Rasmus\t108806\nArchitecture in Helsinki\t108217\nKyuss\t107783\nAs I Lay Dying\t107709\nThe Stills\t107584\nAnimal Collective\t107124\nThe Good Life\t107019\nBeulah\t106983\nAthlete\t106890\nSex Pistols\t106760\nThe Future Sound of London\t106504\nKing Crimson\t106359\nDMX\t106307\nSevendust\t106301\nThe Jesus and Mary Chain\t106256\nAlice Cooper\t106188\nHatebreed\t106143\nBlack Label Society\t106037\nt.A.T.u.\t105891\nEnsiferum\t105891\nSupergrass\t105846\nLou Reed\t105828\nKamelot\t105769\nAnthrax\t105655\nABBA\t105534\nJon Brion\t105304\nMtley Cre\t105258\nEve 6\t105105\nBhse Onkelz\t104757\nLes Savy Fav\t104702\nSantana\t103926\nM.I.A.\t103833\nMy Dying Bride\t103760\nKate Bush\t103551\n\t103468\nViolent Femmes\t103381\nAlien Ant Farm\t103356\nLynyrd Skynyrd\t103302\nStrapping Young Lad\t102904\nPhoenix\t102866\nThe Avalanches\t102855\nThe Sisters of Mercy\t102742\nHooverphonic\t102725\nAndrew Lloyd Webber\t102520\nMinistry\t102023\nThe Zutons\t101757\nVangelis\t101669\nPlaid\t101653\nBrian Wilson\t101518\nMC Chris\t101383\nRichard Cheese\t100814\nTalib Kweli\t100739\nKreator\t100728\nMidtown\t100648\n\t100637\nJoss Stone\t100538\nThe Appleseed Cast\t100537\nFischerspooner\t100367\nComeback Kid\t100356\nJewel\t100230\nSoundtrack\t100218\nApoptygma Berzerk\t100068\nTheme Songs\t99996\nThe Thrills\t99812\nCalexico\t99394\nScorpions\t99301\nAzure Ray\t98965\nHandsome Boy Modeling School\t98869\nDeerhoof\t98710\nMike Oldfield\t98578\nSmash Mouth\t98125\nElectric Light Orchestra\t97965\nBehemoth\t97914\nOperation Ivy\t97911\nDJ Danger Mouse\t97495\nSongs: Ohia\t97418\nThe Wrens\t97390\nFive Iron Frenzy\t96949\nMew\t96441\nUnwritten Law\t96364\nFrdric Chopin\t95786\nBT\t95750\nMarvin Gaye\t95693\nDanny Elfman\t95665\nMichael Andrews\t95540\nCollective Soul\t95357\nStrung Out\t95249\nTricky\t95014\nSunny Day Real Estate\t94983\nThe All-American Rejects\t94883\nSheryl Crow\t94649\nSuede\t94570\nBonnie \u0027Prince\u0027 Billy\t94407\nJohn Coltrane\t94251\nFinger Eleven\t93798\nX JAPAN\t93691\nAt The Gates\t93318\n\t93153\nThe Mighty Mighty Bosstones\t92996\n2 Many DJ\u0027s\t92950\nTears for Fears\t92614\nSavage Garden\t92551\nRatatat\t92490\nSoulfly\t92273\nHot Water Music\t92171\nUNKLE\t92107\nMitch Hedberg\t92068\nLemon Jelly\t92053\nVAST\t91966\nThe Gathering\t91942\nVenetian Snares\t91698\nAntony and the Johnsons\t91696\nThe Fall\t91353\nOrgy\t91313\nJawbreaker\t91061\nDevo\t90983\nSay Anything\t90913\nTortoise\t90878\n!!!\t90748\nNatalie Imbruglia\t90739\nEvery Time I Die\t90659\nStreetlight Manifesto\t90636\nBackstreet Boys\t90163\nRoxette\t90147\nKotiteollisuus\t90092\nThe Locust\t90090\nStabbing Westward\t90040\nXzibit\t89877\nNina Simone\t89448\nMoloko\t89245\nXTC\t89240\nThe Academy Is...\t88903\nVanessa Carlton\t88855\nAnnie\t88694\nmewithoutYou\t88642\nJamie Cullum\t88628\nMercury Rev\t88352\nGomez\t88269\nThe Pogues\t88057\n\t88049\nQueensrche\t87869\nTocotronic\t87826\nNorma Jean\t87746\nPuddle of Mudd\t87507\nJem\t87174\nDo As Infinity\t87091\nThe Jimi Hendrix Experience\t87084\nThe Vandals\t86950\nDJ Krush\t86704\nThe American Analog Set\t86646\nThe Black Keys\t85959\nLiz Phair\t85905\nJames Brown\t85459\nHowie Day\t85324\nDanzig\t85266\nAmorphis\t85215\nNo Use for a Name\t85165\nSeether\t85138\nEmiliana Torrini\t85133\nMcLusky\t84654\nPaul Van Dyk\t84645\nEdguy\t84610\nImmortal Technique\t84402\nKettcar\t84371\nEmperor\t84357\nJuno Reactor\t84337\nMylo\t84179\nUnearth\t84088\nNasum\t83974\nEinstrzende Neubauten\t83974\nThe Rapture\t83847\nSondre Lerche\t83755\nFuel\t83747\nSiouxsie and the Banshees\t83665\nHilary Duff\t83556\nBlindside\t83414\nPig Destroyer\t83393\nFront Line Assembly\t83036\nBox Car Racer\t82795\nReggie And The Full Effect\t82484\nWir sind Helden\t82405\nK\u0027s Choice\t82326\nPublic Enemy\t82312\nGatsby\u0027s American Dream\t82141\n\t82132\nBilly Idol\t81871\nTom Petty and the Heartbreakers\t81419\nCamera Obscura\t81409\nPrimal Scream\t81196\nMoonspell\t80916\nCirca Survive\t80601\nJennifer Lopez\t80581\nJoni Mitchell\t80510\na-ha\t80487\nKelis\t80346\nGang Starr\t80207\nThe Delgados\t80196\nA Silver Mt. Zion\t80043\nThe Donnas\t80034\nP!nk\t80023\nIggy Pop\t79943\nHole\t79938\nThe Von Bondies\t79878\nORANGE RANGE\t79815\nA.C. Newman\t79760\nSoul Coughing\t79345\nHopesfall\t79251\nDef Leppard\t79245\nAmerican Hi-Fi\t79098\nAssemblage 23\t78813\nAcceptance\t78796\nA Static Lullaby\t78557\nEvergrey\t78488\nSteve Vai\t78107\nDrowning Pool\t78097\nSpineShank\t78080\nEmery\t78040\nGavin DeGraw\t77956\nMarillion\t77741\nO-Zone\t77408\nAnastacia\t77140\nThomas Newman\t77108\nInsane Clown Posse\t77017\nGroove Coverage\t76980\nEcho \u0026 the Bunnymen\t76861\nT. Rex\t76777\nGary Jules\t76768\nChicane\t76718\nBlack Rebel Motorcycle Club\t76606\nBeatsteaks\t76480\nKOTOKO\t76445\nBlackalicious\t76158\nJane\u0027s Addiction\t76126\nMalice Mizer\t76119\nMonster Magnet\t75864\nRasputina\t75814\nCovenant\t75731\nRufio\t75676\nThe Music\t75598\nCrowded House\t75593\nPowerman 5000\t75571\nThe Coral\t75551\nCream\t75479\nTracy Chapman\t75354\nSlowdive\t75112\nDinosaur Jr.\t75104\nAnouk\t75096\nThe Aquabats\t75039\nHypocrisy\t74887\nBill Hicks\t74811\nDevin Townsend\t74730\nZZ Top\t74263\nNile\t74243\nDead Poetic\t74209\nImmortal\t74204\nJack Off Jill\t74149\nMatthew Good Band\t74083\nElbow\t74002\nTrapt\t73995\nTiamat\t73946\nMinor Threat\t73794\nTheatre of Tragedy\t73791\nThe Rocket Summer\t73722\nBone Thugs-N-Harmony\t73706\nSoulwax\t73672\nTestament\t73499\nZebrahead\t73388\nChimaira\t73300\nDisney\t73297\nThe (International) Noise Conspiracy\t73279\n\t73121\nBauhaus\t73083\nEverlast\t72980\nRoots Manuva\t72956\nThe Living End\t72949\nBlackmore\u0027s Night\t72865\nSteely Dan\t72865\nJefferson Airplane\t72637\nVertical Horizon\t72636\nSubway to Sally\t72564\nNapalm Death\t72558\nMorbid Angel\t72541\nBillie Holiday\t72354\nBurzum\t72341\nThe Apples In Stereo\t72299\nLil Jon \u0026 The East Side Boyz\t72172\nClinic\t72045\nLali Puna\t72044\nLouis Armstrong\t71936\nAndrew Bird\t71911\nDeltron 3030\t71835\nm-flo\t71723\nTristania\t71698\nWire\t71681\nPropagandhi\t71281\nBathory\t71051\nFront 242\t71022\nBusta Rhymes\t70945\nMadness\t70794\nRX Bandits\t70695\nTom Petty\t70668\nThe Jam\t70644\nBlind Melon\t70621\nFilter\t70603\nMissy Elliott\t70599\nGamma Ray\t70392\nThe Format\t70124\nThe Breeders\t70115\nBuzzcocks\t70009\nHanson\t69947\n(hed) Planet Earth\t69881\nJohn Legend\t69625\nJustin Timberlake\t69564\nDntel\t69532\nPeaches\t69463\nTilly and the Wall\t69332\nDo Make Say Think\t69278\nFeist\t69146\nThe Wallflowers\t69119\nAfter Forever\t69108\nR. Kelly\t68996\nRooney\t68974\nFelix da Housecat\t68933\nThe Cinematic Orchestra\t68748\nBetter Than Ezra\t68663\nCline Dion\t68476\nLooptroop\t68476\nTsunami Bomb\t68445\nO.A.R.\t68389\nFarin Urlaub\t68331\nBruce Dickinson\t68311\nThe Olivia Tremor Control\t68304\nDeath In Vegas\t68242\nStarsailor\t68238\nCoil\t68188\nElla Fitzgerald\t68003\nAndrew W.K.\t68001\nApulanta\t67981\nMouse on Mars\t67879\nAmbulance LTD\t67729\nCarcass\t67685\nhellogoodbye\t67667\nShadows Fall\t67466\n\t67435\nINXS\t67315\nJean-Michel Jarre\t67197\nEmbrace\t67073\nG-Unit\t66908\nNorther\t66757\nPain\t66665\nMonty Python\t66590\nJosh Groban\t66556\nThe Zombies\t66488\nGang Of Four\t66434\nThe Kills\t66302\nThe 69 Eyes\t66043\nAce of Base\t65914\nThe Dust Brothers\t65876\nJets to Brazil\t65820\nBlack Flag\t65787\nJosh Rouse\t65593\nCiara\t65487\nMy Morning Jacket\t65467\nBlue yster Cult\t65463\nThe Specials\t65455\nPhilip Glass\t65438\nPete Yorn\t65363\nDogs Die in Hot Cars\t65353\nHidden in Plain View\t65220\nBOYSETSFIRE\t65190\nTrain\t65146\nLauryn Hill\t65007\nYUP\t64919\nFugees\t64853\nFear Before the March of Flames\t64806\nBonobo\t64703\nAl Green\t64679\nMorphine\t64668\nMark Knopfler\t64435\nKlaus Badelt\t64421\nTRUSTcompany\t64272\nSpiritualized\t64268\nPizzicato Five\t64240\nSamael\t64239\nDarkthrone\t64111\nAntonio Vivaldi\t64036\nDio\t64006\nWill Smith\t63959\nRob Dougan\t63954\nMazzy Star\t63942\nSemisonic\t63907\nWIZO\t63846\nMobb Deep\t63692\nNancy Sinatra\t63672\nSeal\t63624\nShakira\t63571\nLoreena McKennitt\t63516\nClutch\t63391\nEnon\t63278\nThe Dears\t63188\nNatasha Bedingfield\t63059\nErasure\t62984\nEverything But the Girl\t62964\nGhostface\t62723\nThe Bled\t62647\nWilliam Shatner\t62463\nBloodbath\t62435\nCommon\t62005\nThe Thermals\t61983\nDragonForce\t61961\nMono\t61861\nHsker D\t61766\n\t61689\nMurder by Death\t61546\nJames Taylor\t61468\nThe Stooges\t61435\n"
          },
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"result-alert alert-warning\" role\u003d\"alert\"\u003e\u003cbutton type\u003d\"button\" class\u003d\"close\" data-dismiss\u003d\"alert\" aria-label\u003d\"Close\"\u003e\u003cspan aria-hidden\u003d\"true\"\u003e\u0026times;\u003c/span\u003e\u003c/button\u003e\u003cstrong\u003eOutput is truncated\u003c/strong\u003e to 1000 rows. Learn more about \u003cstrong\u003ezeppelin.spark.maxResult\u003c/strong\u003e\u003c/div\u003e\n"
          },
          {
            "type": "TEXT",
            "data": ""
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d39"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1591184778153_1332693355",
      "id": "20200603-114618_1503339983",
      "dateCreated": "2020-06-03 11:46:18.153",
      "dateStarted": "2020-06-03 11:46:40.482",
      "dateFinished": "2020-06-03 11:46:42.026",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nGet least listened artists.",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 12:30:59.346",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eGet least listened artists.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590590069212_-1581829751",
      "id": "20200527-143429_153738922",
      "dateCreated": "2020-05-27 14:34:29.212",
      "dateStarted": "2020-06-03 12:30:59.347",
      "dateFinished": "2020-06-03 12:30:59.353",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval leastListenedArtistsDF \u003d listenedArtistsDF.sort(\"total\")\nleastListenedArtistsDF.show",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:47:58.439",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+-----+\n|                name|total|\n+--------------------+-----+\n|Joe Budden, A Tea...|    1|\n|Rae \u0026 Chritian - ...|    1|\n|Alex Melcher, Peh...|    1|\n|Dolly Parton - Mi...|    1|\n|        Oneiropagida|    1|\n|          Bravissimo|    1|\n|The Middle Spunk ...|    1|\n|The Last Emperor ...|    1|\n|      12 Urban Tribe|    1|\n|3EO35A5QUKMQXL3WV...|    1|\n|         Jon Eberson|    1|\n|gwar - Preskool P...|    1|\n|Ayla-Liebe-Atb Remix|    1|\n|macy gray (bugz i...|    1|\n|Boys to Men \u0026 Cha...|    1|\n|Apani B. Fly Emce...|    1|\n|  Makaveli ft. Storm|    1|\n|       Opration ra|    1|\n|Parle ft jadakiss...|    1|\n|Lil Kim, Mya, Pin...|    1|\n+--------------------+-----+\nonly showing top 20 rows\n\nleastListenedArtistsDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [name: string, total: bigint]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d13"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590591187326_-770675715",
      "id": "20200527-145307_1643419744",
      "dateCreated": "2020-05-27 14:53:07.326",
      "dateStarted": "2020-06-03 10:47:58.472",
      "dateFinished": "2020-06-03 10:47:59.484",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nThere is not much infos, a lot of artists are at one listen.\nShow how many artist are listened less or equal than 10 times, and the frequence for 1 to ten.",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 12:31:12.873",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eThere is not much infos, a lot of artists are at one listen.\u003cbr/\u003eShow how many artist are listened less or equal than 10 times, and the frequence for 1 to ten.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590591212556_783515315",
      "id": "20200527-145332_475861656",
      "dateCreated": "2020-05-27 14:53:32.556",
      "dateStarted": "2020-06-03 12:31:12.874",
      "dateFinished": "2020-06-03 12:31:12.878",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval lessThanTenTimesListenedArtistsDF \u003d listenedArtistsDF.filter(\"total \u003c\u003d 10\")\nval count \u003d lessThanTenTimesListenedArtistsDF.count\nval ratio \u003d count.toDouble / distinctArtistsNumber.toDouble",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 11:57:19.754",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "lessThanTenTimesListenedArtistsDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [name: string, total: bigint]\ncount: Long \u003d 1161120\nratio: Double \u003d 0.7470896434222049\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d45"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590591575297_993223126",
      "id": "20200527-145935_127174988",
      "dateCreated": "2020-05-27 14:59:35.297",
      "dateStarted": "2020-06-03 11:57:19.780",
      "dateFinished": "2020-06-03 11:57:20.780",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nMore than one million are listened less or equal than ten times, it\u0027s about 75% of all artists.\nNow let\u0027s see the distribution :",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 12:25:45.804",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eMore than one million are listened less or equal than ten times, it\u0026rsquo;s about 75% of all artists.\u003cbr/\u003eNow let\u0026rsquo;s see the distribution :\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1591187115117_-1426829179",
      "id": "20200603-122515_1618842214",
      "dateCreated": "2020-06-03 12:25:15.117",
      "dateStarted": "2020-06-03 12:25:45.805",
      "dateFinished": "2020-06-03 12:25:45.812",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval freqOneToTenDF \u003d lessThanTenTimesListenedArtistsDF.groupBy(\"total\").count.sort(\"total\")\nfreqOneToTenDF.show\nz.show(freqOneToTenDF)",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 12:02:26.524",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "1": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "total": "string",
                      "count": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "total",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "count",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+------+\n|total| count|\n+-----+------+\n|    1|494512|\n|    2|220020|\n|    3|127612|\n|    4| 86240|\n|    5| 62579|\n|    6| 48704|\n|    7| 38467|\n|    8| 32332|\n|    9| 27004|\n|   10| 23650|\n+-----+------+\n\n"
          },
          {
            "type": "TABLE",
            "data": "total\tcount\n1\t494512\n2\t220020\n3\t127612\n4\t86240\n5\t62579\n6\t48704\n7\t38467\n8\t32332\n9\t27004\n10\t23650\n"
          },
          {
            "type": "TEXT",
            "data": "freqOneToTenDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [total: bigint, count: bigint]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d52",
            "http://172.17.0.2:4040/jobs/job?id\u003d53"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1591185436485_-2090136469",
      "id": "20200603-115716_703615281",
      "dateCreated": "2020-06-03 11:57:16.485",
      "dateStarted": "2020-06-03 12:02:14.722",
      "dateFinished": "2020-06-03 12:02:19.823",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nThe most artists are listened only one time.\n\nNow compute mean and median of total count listened artists.",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 12:26:18.853",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eThe most artists are listened only one time.\u003c/p\u003e\n\u003cp\u003eNow compute mean and median of total count listened artists.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590750174894_1903396402",
      "id": "20200529-110254_1497574704",
      "dateCreated": "2020-05-29 11:02:54.895",
      "dateStarted": "2020-06-03 12:26:18.853",
      "dateFinished": "2020-06-03 12:26:18.880",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval mean \u003d listenedArtistsDF.agg(avg(\"total\")).head.getDouble(0)\n\nval median \u003d listenedArtistsDF.stat.approxQuantile(\"total\", Array(0.5), 0.01)(0)",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:48:01.974",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "mean: Double \u003d 238.32715067690853\nmedian: Double \u003d 3.0\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d15",
            "http://172.17.0.2:4040/jobs/job?id\u003d16"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590749376871_1302947423",
      "id": "20200529-104936_1595594524",
      "dateCreated": "2020-05-29 10:49:36.871",
      "dateStarted": "2020-06-03 10:48:02.010",
      "dateFinished": "2020-06-03 10:48:04.729",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nWe can see that half of the artists were listened to less than three times, which can be considered a discovery or even a mistake. ",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:48:04.814",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eWe can see that half of the artists were listened to less than three times, which can be considered a discovery or even a mistake.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590762899249_-1376030230",
      "id": "20200529-143459_1353245403",
      "dateCreated": "2020-05-29 14:34:59.250",
      "dateStarted": "2020-06-03 10:48:04.851",
      "dateFinished": "2020-06-03 10:48:04.856",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Building a First Model",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:48:04.950",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eBuilding a First Model\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404072119_591799774",
      "id": "20200525-105432_1663212423",
      "dateCreated": "2020-05-25 10:54:32.119",
      "dateStarted": "2020-06-03 10:48:04.993",
      "dateFinished": "2020-06-03 10:48:04.997",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nimport org.apache.spark.ml.recommendation._\nimport scala.util.Random\n\nval model \u003d new ALS().\n    setSeed(Random.nextLong()).\n    setImplicitPrefs(true).\n    setRank(10).\n    setRegParam(0.01).\n    setAlpha(1.0).\n    setMaxIter(5).\n    setUserCol(\"user\").\n    setItemCol(\"artist\").\n    setRatingCol(\"count\").\n    setPredictionCol(\"prediction\").\n    fit(trainData)",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:48:05.093",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.recommendation._\nimport scala.util.Random\nmodel: org.apache.spark.ml.recommendation.ALSModel \u003d als_ec7cf34b997f\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d17",
            "http://172.17.0.2:4040/jobs/job?id\u003d18",
            "http://172.17.0.2:4040/jobs/job?id\u003d19",
            "http://172.17.0.2:4040/jobs/job?id\u003d20",
            "http://172.17.0.2:4040/jobs/job?id\u003d21",
            "http://172.17.0.2:4040/jobs/job?id\u003d22",
            "http://172.17.0.2:4040/jobs/job?id\u003d23",
            "http://172.17.0.2:4040/jobs/job?id\u003d24",
            "http://172.17.0.2:4040/jobs/job?id\u003d25",
            "http://172.17.0.2:4040/jobs/job?id\u003d26",
            "http://172.17.0.2:4040/jobs/job?id\u003d27",
            "http://172.17.0.2:4040/jobs/job?id\u003d28",
            "http://172.17.0.2:4040/jobs/job?id\u003d29",
            "http://172.17.0.2:4040/jobs/job?id\u003d30",
            "http://172.17.0.2:4040/jobs/job?id\u003d31"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590405875128_638740172",
      "id": "20200525-112435_1359988035",
      "dateCreated": "2020-05-25 11:24:35.128",
      "dateStarted": "2020-06-03 10:48:05.118",
      "dateFinished": "2020-06-03 10:50:48.744",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nmodel.userFactors.show(1, truncate \u003d false)",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:50:48.794",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---+--------------------------------------------------------------------------------------------------------------------------+\n|id |features                                                                                                                  |\n+---+--------------------------------------------------------------------------------------------------------------------------+\n|90 |[0.029493244, 0.15901206, 0.51303715, 0.91269195, 0.33935696, 0.1631303, 0.31652638, -0.63819027, -0.40553758, 0.09596333]|\n+---+--------------------------------------------------------------------------------------------------------------------------+\nonly showing top 1 row\n\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d32"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590406015054_509388477",
      "id": "20200525-112655_1737810644",
      "dateCreated": "2020-05-25 11:26:55.054",
      "dateStarted": "2020-06-03 10:50:48.823",
      "dateFinished": "2020-06-03 10:50:49.159",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Spot Checking Recommendations",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:50:49.223",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eSpot Checking Recommendations\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590414421056_1572219800",
      "id": "20200525-134701_1337255895",
      "dateCreated": "2020-05-25 13:47:01.056",
      "dateStarted": "2020-06-03 10:50:49.252",
      "dateFinished": "2020-06-03 10:50:49.255",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval userID \u003d 1059637\nval existingArtistIDs \u003d trainData.filter($\"user\" \u003d\u003d\u003d userID).select(\"artist\").as[Int].collect()\nartistByID.filter($\"id\" isin (existingArtistIDs:_*)).show()",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:50:49.352",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------+\n|     id|                name|\n+-------+--------------------+\n|1002584|                Nena|\n|1247913|       JamisonParker|\n|1257062|    The Spill Canvas|\n|1257410|tomandandy (ft. K...|\n|1260489|        The Exciters|\n|1260572|    Nightmare Of You|\n|1261496|              J-Kwon|\n|6992072|               angle|\n|   5496| Echo \u0026 the Bunnymen|\n|1150039|        Letter Kills|\n|1283493|            An Angle|\n|1006354|      Pedro the Lion|\n|1085052|             Cordero|\n|     78|             Sublime|\n|1233389|The American Anal...|\n|1234850|         The Hollies|\n|1009156|                 Mae|\n|1003853|        Les Savy Fav|\n|1044920|   Matchbook Romance|\n|   5659|             Midtown|\n+-------+--------------------+\nonly showing top 20 rows\n\nuserID: Int \u003d 1059637\nexistingArtistIDs: Array[Int] \u003d Array(1000010, 1000049, 1000056, 1000062, 1000094, 1000112, 1000113, 1000114, 1000123, 1000130, 1000139, 1000241, 1000263, 1000289, 1000305, 1000320, 1000340, 1000427, 1000428, 1000433, 1000445, 1000527, 1000617, 1000632, 1000676, 1000790, 1000877, 1000890, 1000926, 1000999, 1001007, 1001027, 1001066, 1001068, 1001107, 1001117, 1001130, 1001198, 1001233, 1001249, 1001412, 1001439, 1001482, 1001487, 1001523, 1001530, 1001779, 1001809, 1001828, 1001894, 1002128, 1002204, 1002216, 1002223, 1002225, 1002269, 1002289, 1002326, 1002560, 1002584, 1002723, 1002734, 1002742, 1002850, 1002912, 1003159, 1003176, 1003241, 1003250, 1003568, 1003673, 1003681, 1003689, 1003727, 1003794, 1003853, 1003928, 1004201, 1004226, 1004274, 1004278, 1004294,..."
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d33",
            "http://172.17.0.2:4040/jobs/job?id\u003d34"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590414312973_773327109",
      "id": "20200525-134512_2071793608",
      "dateCreated": "2020-05-25 13:45:12.973",
      "dateStarted": "2020-06-03 10:50:49.377",
      "dateFinished": "2020-06-03 10:50:50.587",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\ndef makeRecommendations(model: ALSModel, userID: Int, howMany: Int): DataFrame \u003d {\n    val toRecommend \u003d model.itemFactors.select($\"id\".as(\"artist\")).withColumn(\"user\", lit(userID))\n    model.transform(toRecommend).select(\"artist\", \"prediction\").orderBy($\"prediction\".desc).limit(howMany)\n}\n\nval topRecommendations \u003d makeRecommendations(model, userID, 5)\ntopRecommendations.show()",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:50:50.677",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+----------+\n| artist|prediction|\n+-------+----------+\n|1006809|  1.315241|\n|1164352| 1.2886244|\n|1014716|  1.262915|\n|1000320| 1.2417011|\n|1013931| 1.2329342|\n+-------+----------+\n\nmakeRecommendations: (model: org.apache.spark.ml.recommendation.ALSModel, userID: Int, howMany: Int)org.apache.spark.sql.DataFrame\ntopRecommendations: org.apache.spark.sql.DataFrame \u003d [artist: int, prediction: float]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d35"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590414339594_-358168064",
      "id": "20200525-134539_310376515",
      "dateCreated": "2020-05-25 13:45:39.594",
      "dateStarted": "2020-06-03 10:50:50.705",
      "dateFinished": "2020-06-03 10:51:01.050",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval recommendedArtistIDs \u003d topRecommendations.select(\"artist\").as[Int].collect()\nartistByID.filter($\"id\" isin (recommendedArtistIDs:_*)).show()",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:51:01.112",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+----------------+\n|     id|            name|\n+-------+----------------+\n|1000320|            MxPx|\n|1013931|  Tegan and Sara|\n|1164352|          Eisley|\n|1006809|Five Iron Frenzy|\n|1014716|       Relient K|\n+-------+----------------+\n\nrecommendedArtistIDs: Array[Int] \u003d Array(1006809, 1164352, 1014716, 1000320, 1013931)\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d36",
            "http://172.17.0.2:4040/jobs/job?id\u003d37"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590414893842_841620200",
      "id": "20200525-135453_1946076405",
      "dateCreated": "2020-05-25 13:54:53.842",
      "dateStarted": "2020-06-03 10:51:01.164",
      "dateFinished": "2020-06-03 10:51:10.610",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\n",
      "user": "anonymous",
      "dateUpdated": "2020-06-03 10:51:10.673",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {}
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1590763718180_1128694673",
      "id": "20200529-144838_813037848",
      "dateCreated": "2020-05-29 14:48:38.180",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "music-recommendator",
  "id": "2F8JB848Y",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "sh:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}