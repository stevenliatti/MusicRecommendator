{
  "paragraphs": [
    {
      "text": "%md\n\n# Music Recommendator\n\n",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:38:36.362",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eMusic Recommendator\u003c/h1\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404160920_724976566",
      "id": "20200525-105600_876779769",
      "dateCreated": "2020-05-25 10:56:00.920",
      "dateStarted": "2020-05-29 14:38:36.386",
      "dateFinished": "2020-05-29 14:38:36.388",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Preparing the Data\n\nLet\u0027s start by downloading the data :\n",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:38:36.485",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003ePreparing the Data\u003c/h2\u003e\n\u003cp\u003eLet\u0026rsquo;s start by downloading the data :\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404204036_-155805845",
      "id": "20200525-105644_555166138",
      "dateCreated": "2020-05-25 10:56:44.037",
      "dateStarted": "2020-05-29 14:38:36.509",
      "dateFinished": "2020-05-29 14:38:36.512",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\ncd /data\nif [[ ! -d profiledata_06-May-2005 ]]\nthen\n    if [[ ! -f profiledata_06-May-2005.tar.xz ]]\n    then \n        echo \"Downloading profiledata_06-May-2005.tar.xz\"\n        curl --silent https://drive.switch.ch/index.php/s/gK6l44wTWixlaeC/download -o profiledata_06-May-2005.tar.xz\n        echo \"Extracting to profiledata_06-May-2005\"\n        tar xfv profiledata_06-May-2005.tar.xz\n    fi\nfi\nls -lhF profiledata_06-May-2005",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:38:36.609",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionSupport": false,
          "completionKey": "TAB"
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "total 464M\n-rw-r--r-- 1 1000 1000 2.8M May  6  2005 artist_alias.txt\n-rw-r--r-- 1 1000 1000  54M May  6  2005 artist_data.txt\n-rw-r--r-- 1 1000 1000 1.3K May 10  2005 README.txt\n-rw-r--r-- 1 1000 1000 407M May  5  2005 user_artist_data.txt\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590395388698_1190528192",
      "id": "20200525-082948_1820188021",
      "dateCreated": "2020-05-25 08:29:48.698",
      "dateStarted": "2020-05-29 14:38:36.639",
      "dateFinished": "2020-05-29 14:38:36.692",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nNext, read the user artist data and transform it in a Dataframe with two columns \"user\" and \"artist\" :",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:38:36.732",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eNext, read the user artist data and transform it in a Dataframe with two columns \u0026ldquo;user\u0026rdquo; and \u0026ldquo;artist\u0026rdquo; :\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404376466_270920040",
      "id": "20200525-105936_1453333316",
      "dateCreated": "2020-05-25 10:59:36.466",
      "dateStarted": "2020-05-29 14:38:36.762",
      "dateFinished": "2020-05-29 14:38:36.765",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval rawUserArtistData \u003d spark.read.textFile(\"/data/profiledata_06-May-2005/user_artist_data.txt\")\nrawUserArtistData.take(5).foreach(println)\n\nval userArtistDF \u003d rawUserArtistData.map { line \u003d\u003e \n    val Array(user, artist, _*) \u003d line.split(\u0027 \u0027)\n    (user.toInt, artist.toInt)\n}.toDF(\"user\", \"artist\")\nuserArtistDF.printSchema\nuserArtistDF.agg(min(\"user\"), max(\"user\"), min(\"artist\"), max(\"artist\")).show()",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:38:36.862",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "1000002 1 55\n1000002 1000006 33\n1000002 1000007 8\n1000002 1000009 144\n1000002 1000010 314\nroot\n |-- user: integer (nullable \u003d false)\n |-- artist: integer (nullable \u003d false)\n\n+---------+---------+-----------+-----------+\n|min(user)|max(user)|min(artist)|max(artist)|\n+---------+---------+-----------+-----------+\n|       90|  2443548|          1|   10794401|\n+---------+---------+-----------+-----------+\n\nrawUserArtistData: org.apache.spark.sql.Dataset[String] \u003d [value: string]\nuserArtistDF: org.apache.spark.sql.DataFrame \u003d [user: int, artist: int]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d74",
            "http://172.17.0.2:4040/jobs/job?id\u003d75"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590403079984_-213506736",
      "id": "20200525-103759_1452771728",
      "dateCreated": "2020-05-25 10:37:59.984",
      "dateStarted": "2020-05-29 14:38:36.895",
      "dateFinished": "2020-05-29 14:39:10.062",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nNext, read the raw artist data and transform it in a Dataframe with two columns \"id\" and \"name\" :",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:39:10.138",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eNext, read the raw artist data and transform it in a Dataframe with two columns \u0026ldquo;id\u0026rdquo; and \u0026ldquo;name\u0026rdquo; :\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404636907_1121945544",
      "id": "20200525-110356_1897971030",
      "dateCreated": "2020-05-25 11:03:56.907",
      "dateStarted": "2020-05-29 14:39:10.164",
      "dateFinished": "2020-05-29 14:39:10.167",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval rawArtistData \u003d spark.read.textFile(\"/data/profiledata_06-May-2005/artist_data.txt\")\nval artistByID \u003d rawArtistData.flatMap { line \u003d\u003e\n    val (id, name) \u003d line.span(_ !\u003d \u0027\\t\u0027)\n    if (name.isEmpty) None\n    else {\n        try Some((id.toInt, name.trim))\n        catch {\n            case _: NumberFormatException \u003d\u003e None\n        }\n    }\n}.toDF(\"id\", \"name\")",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:39:10.263",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "rawArtistData: org.apache.spark.sql.Dataset[String] \u003d [value: string]\nartistByID: org.apache.spark.sql.DataFrame \u003d [id: int, name: string]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404632088_1692483147",
      "id": "20200525-110352_2143376873",
      "dateCreated": "2020-05-25 11:03:52.088",
      "dateStarted": "2020-05-29 14:39:10.283",
      "dateFinished": "2020-05-29 14:39:10.913",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nNext, read the alias artist data and transform it in a Map with artist id for the key and alias for value :",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:39:10.983",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eNext, read the alias artist data and transform it in a Map with artist id for the key and alias for value :\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404719724_1188961969",
      "id": "20200525-110519_1836651915",
      "dateCreated": "2020-05-25 11:05:19.724",
      "dateStarted": "2020-05-29 14:39:11.015",
      "dateFinished": "2020-05-29 14:39:11.022",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval rawArtistAlias \u003d spark.read.textFile(\"/data/profiledata_06-May-2005/artist_alias.txt\")\nval artistAlias \u003d rawArtistAlias.flatMap { line \u003d\u003e\n    val Array(artist, alias) \u003d line.split(\u0027\\t\u0027)\n    if (artist.isEmpty) None\n    else Some((artist.toInt, alias.toInt))\n}.collect().toMap\n//artistAlias.head\n\nartistByID.filter($\"id\" isin (1208690, 1003926)).show()",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:39:11.112",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 92.6833,
              "optionOpen": false
            }
          }
        },
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+----------------+\n|     id|            name|\n+-------+----------------+\n|1208690|Collective Souls|\n|1003926| Collective Soul|\n+-------+----------------+\n\nrawArtistAlias: org.apache.spark.sql.Dataset[String] \u003d [value: string]\nartistAlias: scala.collection.immutable.Map[Int,Int] \u003d Map(1208690 -\u003e 1003926, 2012757 -\u003e 4569, 6949139 -\u003e 1085752, 1109727 -\u003e 1239120, 6772751 -\u003e 1244705, 2070533 -\u003e 1021544, 1157679 -\u003e 2194, 9969617 -\u003e 5630, 2034496 -\u003e 1116214, 6764342 -\u003e 40, 1272489 -\u003e 1278238, 2108744 -\u003e 1009267, 10349857 -\u003e 1000052, 2145319 -\u003e 1020463, 2126338 -\u003e 2717, 10165456 -\u003e 1001169, 6779368 -\u003e 1239506, 10278137 -\u003e 1001523, 9939075 -\u003e 1329390, 2037201 -\u003e 1274155, 1248585 -\u003e 2885, 1106945 -\u003e 1399, 6811322 -\u003e 1019016, 9978396 -\u003e 1784, 6676961 -\u003e 1086433, 2117821 -\u003e 2611, 6863616 -\u003e 1277013, 6895480 -\u003e 1000993, 6831632 -\u003e 1246136, 1001719 -\u003e 1009727, 10135633 -\u003e 4250, 7029291 -\u003e 1034635, 6967939 -\u003e 1002734, 6864694 -\u003e 1017311, 1237279 -\u003e 1029..."
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d76",
            "http://172.17.0.2:4040/jobs/job?id\u003d77"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590403815626_-1753499650",
      "id": "20200525-105015_1244952508",
      "dateCreated": "2020-05-25 10:50:15.626",
      "dateStarted": "2020-05-29 14:39:11.133",
      "dateFinished": "2020-05-29 14:39:14.813",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\n\nimport org.apache.spark.sql._\nimport org.apache.spark.broadcast._\n\n// Cleaning data in bonus\n\n/**\n * Convert count musics to approximatively years of listening\n */\ndef countToYear(count: Int): Boolean \u003d {\n    val avgSongMinutesLength \u003d 4.0\n    avgSongMinutesLength * count.toDouble / 60.0 / 24.0 / 365.0 \u003c 2\n}\n \ndef buildCounts(rawUserArtistData: Dataset[String], bArtistAlias: Broadcast[Map[Int,Int]]): DataFrame \u003d {\n    val unknownId \u003d artistByID.filter($\"name\" \u003d\u003d\u003d \"[unknown]\").select($\"id\").head.getInt(0)\n    val userArtistCleanedDF \u003d userArtistDF.filter($\"artist\" !\u003d\u003d unknownId)\n    \n    rawUserArtistData.map { line \u003d\u003e\n        val Array(userID, artistID, count) \u003d line.split(\u0027 \u0027).map(_.toInt)\n        val finalArtistID \u003d bArtistAlias.value.getOrElse(artistID, artistID)\n        (userID, finalArtistID, count)\n    }.toDF(\"user\", \"artist\", \"count\").filter($\"artist\" !\u003d\u003d unknownId)\n}\nval bArtistAlias \u003d spark.sparkContext.broadcast(artistAlias)\nval trainData \u003d buildCounts(rawUserArtistData, bArtistAlias).filter($\"count\" \u003c 400000)\ntrainData.orderBy(desc(\"count\")).show\ntrainData.cache()",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:39:14.843",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "warning: there were two deprecation warnings; re-run with -deprecation for details\n+-------+-------+------+\n|   user| artist| count|\n+-------+-------+------+\n|1059637|1026440|155895|\n|2069889|1002095|101076|\n|2020513|1007801| 88908|\n|1073421|1004440| 67548|\n|2023977|1007903| 62815|\n|2023977|   2823| 51039|\n|2014936|     82| 36083|\n|2069337|1006134| 34800|\n|2013784|1004059| 32768|\n|2069337|1007027| 31321|\n|1073435|1105069| 30043|\n|2023977|1000156| 29983|\n|1052225|1256375| 29933|\n|2017397|1000427| 26394|\n|1045479|1000113| 26135|\n|2062243|6901343| 26107|\n|1039100|1275996| 25858|\n|1053554|    478| 25303|\n|2017397|1004296| 24876|\n|2216281|   5705| 24067|\n+-------+-------+------+\nonly showing top 20 rows\n\nimport org.apache.spark.sql._\nimport org.apache.spark.broadcast._\ncountToYear: (count: Int)Boolean\nbuildCounts: (rawUserArtistData: org.apache.spark.sql.Dataset[String], bArtistAlias: org.apache.spark.broadcast.Broadcast[Map[Int,Int]])org.apache.spark.sql.DataFrame\nbArtistAlias: org.apache.spark.broadcast.Broadcast[scala.collection.immutable.Map[Int,Int]] \u003d Broadcast(148)\ntrainData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [user: int, artist: int ... 1 more field]\nres81: trainData.type \u003d [user: int, artist: int ... 1 more field]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d78",
            "http://172.17.0.2:4040/jobs/job?id\u003d79"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590404829942_-1453554254",
      "id": "20200525-110709_1785781047",
      "dateCreated": "2020-05-25 11:07:09.942",
      "dateStarted": "2020-05-29 14:39:14.866",
      "dateFinished": "2020-05-29 14:40:15.866",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Statistics",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:40:15.917",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eStatistics\u003c/h1\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590414919792_1966495056",
      "id": "20200525-135519_1912337093",
      "dateCreated": "2020-05-25 13:55:19.792",
      "dateStarted": "2020-05-29 14:40:15.942",
      "dateFinished": "2020-05-29 14:40:15.945",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Describe statistics",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:40:16.042",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eDescribe statistics\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590590237186_-623096228",
      "id": "20200527-143717_23609195",
      "dateCreated": "2020-05-27 14:37:17.186",
      "dateStarted": "2020-05-29 14:40:16.062",
      "dateFinished": "2020-05-29 14:40:16.064",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval userSummary \u003d trainData.describe(\"user\")\nuserSummary.show\n\nval artistSummary \u003d trainData.describe(\"artist\")\nartistSummary.show\n\nval countSummary \u003d trainData.describe(\"count\")\ncountSummary.show",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:40:16.162",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+\n|summary|              user|\n+-------+------------------+\n|  count|          24259165|\n|   mean|1947645.8761629264|\n| stddev| 495961.5513546217|\n|    min|                90|\n|    max|           2443548|\n+-------+------------------+\n\n+-------+------------------+\n|summary|            artist|\n+-------+------------------+\n|  count|          24259165|\n|   mean|1701022.6841495163|\n| stddev|  2516504.31072957|\n|    min|                 1|\n|    max|          10794401|\n+-------+------------------+\n\n+-------+------------------+\n|summary|             count|\n+-------+------------------+\n|  count|          24259165|\n|   mean|15.265846577984032|\n| stddev| 89.56463917606709|\n|    min|                 1|\n|    max|            155895|\n+-------+------------------+\n\nuserSummary: org.apache.spark.sql.DataFrame \u003d [summary: string, user: string]\nartistSummary: org.apache.spark.sql.DataFrame \u003d [summary: string, artist: string]\ncountSummary: org.apache.spark.sql.DataFrame \u003d [summary: string, count: string]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d80",
            "http://172.17.0.2:4040/jobs/job?id\u003d81",
            "http://172.17.0.2:4040/jobs/job?id\u003d82"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590590249472_873829545",
      "id": "20200527-143729_1355604663",
      "dateCreated": "2020-05-27 14:37:29.472",
      "dateStarted": "2020-05-29 14:40:16.182",
      "dateFinished": "2020-05-29 14:41:39.376",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Data fusion\nCompute a Dataframe with user id, artist id, artist name and count for later uses.",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:41:39.446",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eData fusion\u003c/h2\u003e\n\u003cp\u003eCompute a Dataframe with user id, artist id, artist name and count for later uses.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590594064315_1755221963",
      "id": "20200527-154104_1970292027",
      "dateCreated": "2020-05-27 15:41:04.315",
      "dateStarted": "2020-05-29 14:41:39.468",
      "dateFinished": "2020-05-29 14:41:39.472",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval userArtistNamesCountDF \u003d \n    trainData\n    .join(artistByID, artistByID(\"id\") \u003d\u003d\u003d trainData(\"artist\"))\n    .select(\"user\", \"artist\", \"name\", \"count\")\nuserArtistNamesCountDF.cache\nuserArtistNamesCountDF.show",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:41:39.567",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------+----------+-----+\n|   user|artist|      name|count|\n+-------+------+----------+-----+\n|1000019|   463|The Smiths|    1|\n|1000020|   463|The Smiths|  199|\n|1000022|   463|The Smiths|   20|\n|1000033|   463|The Smiths|  466|\n|1000056|   463|The Smiths|   10|\n|1000067|   463|The Smiths|   18|\n|1000070|   463|The Smiths|  399|\n|1000073|   463|The Smiths|    3|\n|1000077|   463|The Smiths|   15|\n|1000082|   463|The Smiths|   16|\n|1000090|   463|The Smiths|    1|\n|1000096|   463|The Smiths|    2|\n|1000099|   463|The Smiths|   10|\n|1000106|   463|The Smiths|    1|\n|1000114|   463|The Smiths|    3|\n|1000117|   463|The Smiths|    1|\n|1000119|   463|The Smiths|   14|\n|1000124|   463|The Smiths|    2|\n|1000125|   463|The Smiths|    8|\n|1000127|   463|The Smiths|    2|\n+-------+------+----------+-----+\nonly showing top 20 rows\n\nuserArtistNamesCountDF: org.apache.spark.sql.DataFrame \u003d [user: int, artist: int ... 2 more fields]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d83"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590590062800_2109207725",
      "id": "20200527-143422_594483041",
      "dateCreated": "2020-05-27 14:34:22.800",
      "dateStarted": "2020-05-29 14:41:39.595",
      "dateFinished": "2020-05-29 14:41:51.594",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nGet users number",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:41:51.604",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eGet users number\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590747813508_-1257535935",
      "id": "20200529-102333_1988446988",
      "dateCreated": "2020-05-29 10:23:33.508",
      "dateStarted": "2020-05-29 14:41:51.643",
      "dateFinished": "2020-05-29 14:41:51.646",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval distinctUsersNumber \u003d userArtistNamesCountDF.select(\"user\").distinct.count\nprintln(distinctUsersNumber)",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:41:51.743",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "148077\ndistinctUsersNumber: Long \u003d 148077\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d84"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590747828635_-1911174006",
      "id": "20200529-102348_186273132",
      "dateCreated": "2020-05-29 10:23:48.636",
      "dateStarted": "2020-05-29 14:41:51.765",
      "dateFinished": "2020-05-29 14:43:26.017",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nGet artists number",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:43:26.064",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eGet artists number\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590747661487_613552488",
      "id": "20200529-102101_551270995",
      "dateCreated": "2020-05-29 10:21:01.487",
      "dateStarted": "2020-05-29 14:43:26.087",
      "dateFinished": "2020-05-29 14:43:26.089",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval distinctArtistsNumber \u003d userArtistNamesCountDF.select(\"artist\").distinct.count\nprintln(distinctArtistsNumber)",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:43:26.186",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "1554191\ndistinctArtistsNumber: Long \u003d 1554191\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d85"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590747287371_1343407231",
      "id": "20200529-101447_1422946071",
      "dateCreated": "2020-05-29 10:14:47.371",
      "dateStarted": "2020-05-29 14:43:26.207",
      "dateFinished": "2020-05-29 14:43:29.881",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Get most listened artists\nGet the total amount music listened for each artist",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:43:29.909",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eGet most listened artists\u003c/h2\u003e\n\u003cp\u003eGet the total amount music listened for each artist\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590589883731_1756040608",
      "id": "20200527-143123_948169887",
      "dateCreated": "2020-05-27 14:31:23.731",
      "dateStarted": "2020-05-29 14:43:29.931",
      "dateFinished": "2020-05-29 14:43:29.934",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval listenedArtistsDF \u003d userArtistNamesCountDF.groupBy(\"name\").sum(\"count\").select($\"name\", $\"sum(count)\" as \"total\")\nlistenedArtistsDF.cache\n\nval mostListenedArtistsDF \u003d listenedArtistsDF.sort(desc(\"total\"))\nmostListenedArtistsDF.show",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:43:30.031",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+-------+\n|                name|  total|\n+--------------------+-------+\n|           Radiohead|2502596|\n|         The Beatles|2259825|\n|           Green Day|1931143|\n|           Metallica|1543430|\n|          Pink Floyd|1399665|\n|     Nine Inch Nails|1361977|\n|        Modest Mouse|1328969|\n|         Bright Eyes|1234773|\n|             Nirvana|1203348|\n|                Muse|1148684|\n| Death Cab for Cutie|1117277|\n|Red Hot Chili Pep...|1088701|\n|       Elliott Smith|1080542|\n|           Rammstein|1047119|\n|         Linkin Park|1028921|\n|                  U2|1015494|\n|           Nightwish|1010869|\n|            Coldplay|1001417|\n|    System of a Down| 986483|\n|            Interpol| 979770|\n+--------------------+-------+\nonly showing top 20 rows\n\nlistenedArtistsDF: org.apache.spark.sql.DataFrame \u003d [name: string, total: bigint]\nmostListenedArtistsDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [name: string, total: bigint]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d86"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590595127492_295793374",
      "id": "20200527-155847_268656697",
      "dateCreated": "2020-05-27 15:58:47.492",
      "dateStarted": "2020-05-29 14:43:30.052",
      "dateFinished": "2020-05-29 14:44:03.929",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Get least listened artists",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:44:03.972",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eGet least listened artists\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590590069212_-1581829751",
      "id": "20200527-143429_153738922",
      "dateCreated": "2020-05-27 14:34:29.212",
      "dateStarted": "2020-05-29 14:44:03.993",
      "dateFinished": "2020-05-29 14:44:03.997",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval leastListenedArtistsDF \u003d listenedArtistsDF.sort(\"total\")\nleastListenedArtistsDF.show",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:44:04.092",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+-----+\n|                name|total|\n+--------------------+-----+\n|Joe Budden, A Tea...|    1|\n|Rae \u0026 Chritian - ...|    1|\n|Alex Melcher, Peh...|    1|\n|Dolly Parton - Mi...|    1|\n|        Oneiropagida|    1|\n|          Bravissimo|    1|\n|The Middle Spunk ...|    1|\n|The Last Emperor ...|    1|\n|      12 Urban Tribe|    1|\n|3EO35A5QUKMQXL3WV...|    1|\n|         Jon Eberson|    1|\n|gwar - Preskool P...|    1|\n|Ayla-Liebe-Atb Remix|    1|\n|macy gray (bugz i...|    1|\n|Boys to Men \u0026 Cha...|    1|\n|Apani B. Fly Emce...|    1|\n|  Makaveli ft. Storm|    1|\n|       Opération raï|    1|\n|Parle ft jadakiss...|    1|\n|Lil Kim, Mya, Pin...|    1|\n+--------------------+-----+\nonly showing top 20 rows\n\nleastListenedArtistsDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [name: string, total: bigint]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d87"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590591187326_-770675715",
      "id": "20200527-145307_1643419744",
      "dateCreated": "2020-05-27 14:53:07.326",
      "dateStarted": "2020-05-29 14:44:04.114",
      "dateFinished": "2020-05-29 14:44:05.717",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nShow how many artist are listened less or equal than 10 times, and the frequence for 1 to ten",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:44:05.815",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eShow how many artist are listened less or equal than 10 times, and the frequence for 1 to ten\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590591212556_783515315",
      "id": "20200527-145332_475861656",
      "dateCreated": "2020-05-27 14:53:32.556",
      "dateStarted": "2020-05-29 14:44:05.837",
      "dateFinished": "2020-05-29 14:44:05.841",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval lessThanTenTimesListenedArtistsDF \u003d listenedArtistsDF.filter(\"total \u003c\u003d 10\").distinct.count",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:44:05.937",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "lessThanTenTimesListenedArtistsDF: Long \u003d 1161120\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d88"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590591575297_993223126",
      "id": "20200527-145935_127174988",
      "dateCreated": "2020-05-27 14:59:35.297",
      "dateStarted": "2020-05-29 14:44:05.961",
      "dateFinished": "2020-05-29 14:44:08.685",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nCompute mean and median of total count listened artists",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:44:08.763",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eCompute mean and median of total count listened artists\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590750174894_1903396402",
      "id": "20200529-110254_1497574704",
      "dateCreated": "2020-05-29 11:02:54.895",
      "dateStarted": "2020-05-29 14:44:08.784",
      "dateFinished": "2020-05-29 14:44:08.787",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval mean \u003d listenedArtistsDF.agg(avg(\"total\")).head.getDouble(0)\n\nval median \u003d listenedArtistsDF.stat.approxQuantile(\"total\", Array(0.5), 0.01)(0)",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:44:08.884",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "mean: Double \u003d 238.32715067690853\nmedian: Double \u003d 3.0\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d89",
            "http://172.17.0.2:4040/jobs/job?id\u003d90"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590749376871_1302947423",
      "id": "20200529-104936_1595594524",
      "dateCreated": "2020-05-29 10:49:36.871",
      "dateStarted": "2020-05-29 14:44:08.907",
      "dateFinished": "2020-05-29 14:44:13.024",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nWe can see that half of the artists were listened to less than three times, which can be considered a discovery or even a mistake. ",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:44:13.115",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eWe can see that half of the artists were listened to less than three times, which can be considered a discovery or even a mistake.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590762899249_-1376030230",
      "id": "20200529-143459_1353245403",
      "dateCreated": "2020-05-29 14:34:59.250",
      "dateStarted": "2020-05-29 14:44:13.139",
      "dateFinished": "2020-05-29 14:44:13.143",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Building a First Model",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:44:13.237",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eBuilding a First Model\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590404072119_591799774",
      "id": "20200525-105432_1663212423",
      "dateCreated": "2020-05-25 10:54:32.119",
      "dateStarted": "2020-05-29 14:44:13.260",
      "dateFinished": "2020-05-29 14:44:13.265",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nimport org.apache.spark.ml.recommendation._\nimport scala.util.Random\n\nval model \u003d new ALS().\n    setSeed(Random.nextLong()).\n    setImplicitPrefs(true).\n    setRank(10).\n    setRegParam(0.01).\n    setAlpha(1.0).\n    setMaxIter(5).\n    setUserCol(\"user\").\n    setItemCol(\"artist\").\n    setRatingCol(\"count\").\n    setPredictionCol(\"prediction\").\n    fit(trainData)",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:44:13.359",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.recommendation._\nimport scala.util.Random\nmodel: org.apache.spark.ml.recommendation.ALSModel \u003d als_e839bd40150c\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d91",
            "http://172.17.0.2:4040/jobs/job?id\u003d92",
            "http://172.17.0.2:4040/jobs/job?id\u003d93",
            "http://172.17.0.2:4040/jobs/job?id\u003d94",
            "http://172.17.0.2:4040/jobs/job?id\u003d95",
            "http://172.17.0.2:4040/jobs/job?id\u003d96",
            "http://172.17.0.2:4040/jobs/job?id\u003d97",
            "http://172.17.0.2:4040/jobs/job?id\u003d98",
            "http://172.17.0.2:4040/jobs/job?id\u003d99",
            "http://172.17.0.2:4040/jobs/job?id\u003d100",
            "http://172.17.0.2:4040/jobs/job?id\u003d101",
            "http://172.17.0.2:4040/jobs/job?id\u003d102",
            "http://172.17.0.2:4040/jobs/job?id\u003d103",
            "http://172.17.0.2:4040/jobs/job?id\u003d104",
            "http://172.17.0.2:4040/jobs/job?id\u003d105"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590405875128_638740172",
      "id": "20200525-112435_1359988035",
      "dateCreated": "2020-05-25 11:24:35.128",
      "dateStarted": "2020-05-29 14:44:13.386",
      "dateFinished": "2020-05-29 14:48:16.868",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nmodel.userFactors.show(1, truncate \u003d false)",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:48:16.966",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---+-------------------------------------------------------------------------------------------------------------------------+\n|id |features                                                                                                                 |\n+---+-------------------------------------------------------------------------------------------------------------------------+\n|90 |[-0.25167885, 0.56719315, -0.2253514, -1.0045187, -0.13641572, -0.73246527, 0.43280968, 0.5634426, 0.3189538, 0.64502937]|\n+---+-------------------------------------------------------------------------------------------------------------------------+\nonly showing top 1 row\n\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d106"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590406015054_509388477",
      "id": "20200525-112655_1737810644",
      "dateCreated": "2020-05-25 11:26:55.054",
      "dateStarted": "2020-05-29 14:48:16.992",
      "dateFinished": "2020-05-29 14:48:17.293",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Spot Checking Recommendations",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:48:17.391",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eSpot Checking Recommendations\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1590414421056_1572219800",
      "id": "20200525-134701_1337255895",
      "dateCreated": "2020-05-25 13:47:01.056",
      "dateStarted": "2020-05-29 14:48:17.413",
      "dateFinished": "2020-05-29 14:48:17.416",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval userID \u003d 1059637\nval existingArtistIDs \u003d trainData.filter($\"user\" \u003d\u003d\u003d userID).select(\"artist\").as[Int].collect()\nartistByID.filter($\"id\" isin (existingArtistIDs:_*)).show()",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:48:17.513",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------+\n|     id|                name|\n+-------+--------------------+\n|1002584|                Nena|\n|1247913|       JamisonParker|\n|1257062|    The Spill Canvas|\n|1257410|tomandandy (ft. K...|\n|1260489|        The Exciters|\n|1260572|    Nightmare Of You|\n|1261496|              J-Kwon|\n|6992072|               angle|\n|   5496| Echo \u0026 the Bunnymen|\n|1150039|        Letter Kills|\n|1283493|            An Angle|\n|1006354|      Pedro the Lion|\n|1085052|             Cordero|\n|     78|             Sublime|\n|1233389|The American Anal...|\n|1234850|         The Hollies|\n|1009156|                 Mae|\n|1003853|        Les Savy Fav|\n|1044920|   Matchbook Romance|\n|   5659|             Midtown|\n+-------+--------------------+\nonly showing top 20 rows\n\nuserID: Int \u003d 1059637\nexistingArtistIDs: Array[Int] \u003d Array(1000010, 1000049, 1000056, 1000062, 1000094, 1000112, 1000113, 1000114, 1000123, 1000130, 1000139, 1000241, 1000263, 1000289, 1000305, 1000320, 1000340, 1000427, 1000428, 1000433, 1000445, 1000527, 1000617, 1000632, 1000676, 1000790, 1000877, 1000890, 1000926, 1000999, 1001007, 1001027, 1001066, 1001068, 1001107, 1001117, 1001130, 1001198, 1001233, 1001249, 1001412, 1001439, 1001482, 1001487, 1001523, 1001530, 1001779, 1001809, 1001828, 1001894, 1002128, 1002204, 1002216, 1002223, 1002225, 1002269, 1002289, 1002326, 1002560, 1002584, 1002723, 1002734, 1002742, 1002850, 1002912, 1003159, 1003176, 1003241, 1003250, 1003568, 1003673, 1003681, 1003689, 1003727, 1003794, 1003853, 1003928, 1004201, 1004226, 1004274, 1004278, 1004294,..."
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d107",
            "http://172.17.0.2:4040/jobs/job?id\u003d108"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590414312973_773327109",
      "id": "20200525-134512_2071793608",
      "dateCreated": "2020-05-25 13:45:12.973",
      "dateStarted": "2020-05-29 14:48:17.539",
      "dateFinished": "2020-05-29 14:48:20.104",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\ndef makeRecommendations(model: ALSModel, userID: Int, howMany: Int): DataFrame \u003d {\n    val toRecommend \u003d model.itemFactors.select($\"id\".as(\"artist\")).withColumn(\"user\", lit(userID))\n    model.transform(toRecommend).select(\"artist\", \"prediction\").orderBy($\"prediction\".desc).limit(howMany)\n}\n\nval topRecommendations \u003d makeRecommendations(model, userID, 5)\ntopRecommendations.show()",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:48:20.140",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+----------+\n| artist|prediction|\n+-------+----------+\n|1037970| 1.3176978|\n|1007614| 1.2994831|\n|1003249| 1.2943854|\n|   2814| 1.2121735|\n|1253195| 1.2061849|\n+-------+----------+\n\nmakeRecommendations: (model: org.apache.spark.ml.recommendation.ALSModel, userID: Int, howMany: Int)org.apache.spark.sql.DataFrame\ntopRecommendations: org.apache.spark.sql.DataFrame \u003d [artist: int, prediction: float]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d109"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590414339594_-358168064",
      "id": "20200525-134539_310376515",
      "dateCreated": "2020-05-25 13:45:39.594",
      "dateStarted": "2020-05-29 14:48:20.167",
      "dateFinished": "2020-05-29 14:48:38.172",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval recommendedArtistIDs \u003d topRecommendations.select(\"artist\").as[Int].collect()\nartistByID.filter($\"id\" isin (recommendedArtistIDs:_*)).show()",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:48:38.180",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------+\n|     id|                name|\n+-------+--------------------+\n|   2814|             50 Cent|\n|1007614|               Jay-Z|\n|1037970|          Kanye West|\n|1003249|            Ludacris|\n|1253195|Lil Jon \u0026 The Eas...|\n+-------+--------------------+\n\nrecommendedArtistIDs: Array[Int] \u003d Array(1037970, 1007614, 1003249, 2814, 1253195)\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.17.0.2:4040/jobs/job?id\u003d110",
            "http://172.17.0.2:4040/jobs/job?id\u003d111"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1590414893842_841620200",
      "id": "20200525-135453_1946076405",
      "dateCreated": "2020-05-25 13:54:53.842",
      "dateStarted": "2020-05-29 14:48:38.217",
      "dateFinished": "2020-05-29 14:48:57.269",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\n",
      "user": "anonymous",
      "dateUpdated": "2020-05-29 14:48:38.181",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1590763718180_1128694673",
      "id": "20200529-144838_813037848",
      "dateCreated": "2020-05-29 14:48:38.180",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "music-recommendator",
  "id": "2F8JB848Y",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "sh:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}